<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Example for Execution of Compiled MDL Materials (CPU)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="images/arcicon.ico" rel="shortcut icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_custom_stylesheet_1_8_4.css" rel="stylesheet" type="text/css"/>
<link rel='stylesheet' href='webfonts/librebaskerville/stylesheet.css' type='text/css'/>
<link rel='stylesheet' href='webfonts/sourcesanspro/stylesheet.css' type='text/css'/>
<!--ARC-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="blackheader">
<span id="blackheader_title">MDL SDK API</span>
<span>
<img src="images/nvidia_logo_transpbg.gif" alt="nvidia_logo_transpbg.gif" style=" height:1.25em; width:6.806em;"/></span>
<span id="blackheader_uplink">
<a href='../index.html' class='top_page_nav'>Up</a>
</span>
</div>
<!--
<div id="titlearea">
   <span id="projectname">
     <a id="titlelink" href="../../index.html">
       MDL SDK API
     </a>
   </span>
     <a id="projectlogo" href="http://www.nvidia-arc.com">
       <img alt="NVIDIA logo" src="images/nvidia_logo.png" style="height:2em;">
       </a>
     <a href='../index.html' class='top_page_nav'>Up</a>
</div>
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mi_neuray_example_execution_native.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example for Execution of Compiled MDL Materials (CPU) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="right"> [<a class="el" href="mi_neuray_example_code_gen.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_execution_ptx.html">Next</a>] </div><p>This example shows how a renderer can call the code generated by the "native" backend for compiled materials to evaluate sub-expressions of multiple materials on the CPU.</p>
<h1><a class="anchor" id="example_execution_native_new"></a>
New Topics</h1>
<ul>
<li>MDL material state (CPU)</li>
<li>Execution of generated code (CPU)</li>
<li>Texture handling</li>
</ul>
<h1><a class="anchor" id="example_execution_native_descr"></a>
Detailed Description</h1>
<dl>
<dt><b>MDL material state (CPU)</b> </dt>
<dd><p class="startdd"><br/>
 The MDL material state structure <a class="el" href="group__mi__neuray__mdl__compiler.html#ga8a42cb80b6772ce4b266f2311b0561c1" title="The MDL material state structure. ">mi::neuraylib::Shading_state_material</a> is a representation of the renderer state as defined in section 19 "Renderer state" in the MDL specification. It is used to make the state of the renderer (like the position of an intersection point on the surface, the shading normal and the texture coordinates) available to the generated code.</p>
<p>Here's the material state structure just for reference:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Shading_state_material {</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>           normal;              <span class="comment">// state::normal() result</span></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>           geom_normal;         <span class="comment">// state::geom_normal() result</span></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>           position;            <span class="comment">// state::position() result</span></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#gace7184614a2cd1fe32fa74371363a8bb" title="A float. ">tct_float</a>            animation_time;      <span class="comment">// state::animation_time() result</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>    *text_coords;         <span class="comment">// state::texture_coordinate() table</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>    *tangent_u;           <span class="comment">// state::texture_tangent_u() table</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga7b42ad07f32f1ff518cf07c669373054" title="A float3. ">tct_float3</a>    *tangent_v;           <span class="comment">// state::texture_tangent_v() table</span></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga90866c9153726d2f37d8c3d496e68e20" title="A float4. ">tct_float4</a>          *text_results;        <span class="comment">// texture results lookup table</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>          *ro_data_segment;     <span class="comment">// read-only data segment</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga90866c9153726d2f37d8c3d496e68e20" title="A float4. ">tct_float4</a>    *world_to_object;     <span class="comment">// world-to-object transform matrix</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga90866c9153726d2f37d8c3d496e68e20" title="A float4. ">tct_float4</a>    *object_to_world;     <span class="comment">// object-to-world transform matrix</span></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#gaca6ce0271185507334fbd7db15743e51" title="An int. ">tct_int</a>              object_id;           <span class="comment">// state::object_id() result</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>Please refer to the structure documentation for more information.</p>
<p>In this example, we fill the material state structure with some example values and only use one texture space. For the world-to-object and object-to-world transformation matrices we use identity matrices. We will iterate the <code>position</code> and <code>text_coords</code> fields over a 2x2 quad around the center of the world with position <code>x</code> and <code>y</code> coordinates ranging from -1 to 1 and the texture uv-coordinates ranging from 0 to 1, respectively. </p>
<p class="enddd"></p>
</dd>
<dt><b>Execution of generated code (CPU)</b> </dt>
<dd><p class="startdd"><br/>
 For the native (CPU) backend, filling this structure is actually already enough to prepare the execution of the generated code. Calling <a class="el" href="group__mi__neuray__mdl__compiler.html#ga0d8a1db424af9c982185f001784441be" title="Run this code on the native CPU with the given captured arguments block. ">mi::neuraylib::ITarget_code::execute()</a> with the material state and a sufficiently large result buffer will fill the buffer with the requested result. In this example, we will provide a <code>NULL</code> pointer as a target argument block. For instance compilation, the target argument block parameter is not used, and for class compilation, providing a <code>NULL</code> pointer will result in the default target argument block for the used material instance. See <a class="el" href="mi_neuray_compiler.html#mi_neuray_compilation_modes">Instance-compilation and class-compilation</a> for more details about compilation modes.</p>
<p>In this example, we bake a sub-expression of a material into a texture by executing the generated code for every texel updating the material state accordingly. At the end, we write the texture to disk. </p>
<p class="enddd"></p>
</dd>
<dt><b>Texture handling</b> </dt>
<dd><p class="startdd"><br/>
 Per default, the MDL SDK provides a built-in runtime which handles texture access functions (texture lookups etc.). In some situations, you may however want to provide your own implementation. This requires you to disable the built-in texture handler by setting the <a class="el" href="classmi_1_1neuraylib_1_1IMdl__backend.html" title="MDL backends allow to transform compiled material instances or function calls into target code...">mi::neuraylib::IMdl_backend</a> option <code>use_builtin_resource_handler</code> to <code>"off"</code> (via <a class="el" href="group__mi__neuray__mdl__compiler.html#ga1301dec05ba862ca7745814367811f15" title="Sets a backend option. ">mi::neuraylib::IMdl_backend::set_option()</a>). It also requires you to implement the following functions:</p>
<ul>
<li>tex_lookup_float4_2d</li>
<li>tex_lookup_float3_2d</li>
<li>tex_texel_float4_2d</li>
<li>tex_lookup_float4_3d</li>
<li>tex_lookup_float3_3d</li>
<li>tex_texel_float4_3d</li>
<li>tex_lookup_float4_cube</li>
<li>tex_lookup_float3_cube</li>
<li>tex_resolution_2d</li>
</ul>
<p>Except for the last one, these functions correspond directly to the functions described in section 20.3 "Standard library functions - Texture" in the MDL specification.</p>
<p>You pass your functions to the MDL SDK via an instance of the struct <a class="el" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> when calling any of the <a class="el" href="group__mi__neuray__mdl__compiler.html#ga0d8a1db424af9c982185f001784441be" title="Run this code on the native CPU with the given captured arguments block. ">mi::neuraylib::ITarget_code::execute</a>*() functions. The <a class="el" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> has a vtable parameter which contains function pointers matching the signature of the required functions. These function pointers need to point to your functions.</p>
<p>An example implementation (limited to 2D texture lookups for now) can be found in texture_support.h. To switch example_execution_native to the custom texturing code, please disable the define <code>USE_BUILTIN_TEXTURE_RUNTIME</code> on top of example_execution_native.cpp.</p>
<p></p>
<p class="enddd"></p>
</dd>
</dl>
<h1><a class="anchor" id="example_execution_native"></a>
Example Source</h1>
<p><b>Source Code Location:</b> <code>examples/mdl_sdk/execution_native/example_execution_native.cpp</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// examples/mdl_sdk/execution_native/example_execution_native.cpp</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Introduces the execution of generated code for compiled materials for</span></div>
<div class="line"><span class="comment">// the native (CPU) backend and shows how to manually bake a material</span></div>
<div class="line"><span class="comment">// sub-expression to a texture.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;example_shared.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;texture_support_native.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Command line options structure.</span></div>
<div class="line"><span class="keyword">struct </span>Options {</div>
<div class="line">    <span class="comment">// An result output file name.</span></div>
<div class="line">    std::string outputfile;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The resolution of the display / image.</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> res_x, res_y;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Whether class compilation should be used for the materials.</span></div>
<div class="line">    <span class="keywordtype">bool</span> use_class_compilation;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Whether the custom texture runtime should be used.</span></div>
<div class="line">    <span class="keywordtype">bool</span> use_custom_tex_runtime;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Whether derivative support should be enabled.</span></div>
<div class="line">    <span class="comment">// This example does not support derivatives in combination with the custom texture runtime.</span></div>
<div class="line">    <span class="keywordtype">bool</span> enable_derivatives;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Material to use.</span></div>
<div class="line">    std::string material_name;</div>
<div class="line"></div>
<div class="line">    Options()</div>
<div class="line">        : outputfile(<span class="stringliteral">&quot;example_native.png&quot;</span>)</div>
<div class="line">        , res_x(700)</div>
<div class="line">        , res_y(520)</div>
<div class="line">        , use_class_compilation(false)</div>
<div class="line">        , use_custom_tex_runtime(false)</div>
<div class="line">        , enable_derivatives(false)</div>
<div class="line">    {}</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// The last row is always implied to be (0, 0, 0, 1).</span></div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classmi_1_1math_1_1Matrix.html" title="NxM-dimensional matrix class template of fixed dimensions. ">mi::Float32_3_4</a> identity(</div>
<div class="line">    1.0f, 0.0f, 0.0f, 0.0f,</div>
<div class="line">    0.0f, 1.0f, 0.0f, 0.0f,</div>
<div class="line">    0.0f, 0.0f, 1.0f, 0.0f</div>
<div class="line">);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// Creates an instance of the given material.</span></div>
<div class="line"><span class="keywordtype">void</span> create_material_instance(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>* mdl_factory,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html" title="API component for MDL related import and export operations. ">mi::neuraylib::IMdl_impexp_api</a>* mdl_impexp_api,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html" title="The execution context can be used to query status information like error and warning messages concern...">mi::neuraylib::IMdl_execution_context</a>* context,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* material_name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* instance_name)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// split module and material name</span></div>
<div class="line">    std::string module_name, material_simple_name;</div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::parse_cmd_argument_material_name(</div>
<div class="line">        material_name, module_name, material_simple_name, <span class="keyword">true</span>))</div>
<div class="line">            exit_failure();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Load the module.</span></div>
<div class="line">    mdl_impexp_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html#a5e195d80915190eb40c5995ccfeaa4c9" title="Loads an MDL module from disk (or a builtin module) into the database. ">load_module</a>(transaction, module_name.c_str(), context);</div>
<div class="line">    <span class="keywordflow">if</span> (!print_messages(context))</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Loading module &#39;%s&#39; failed.&quot;</span>, module_name.c_str());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get the database name for the module we loaded</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IString&gt;</a> module_db_name(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a72a27c9e0d66e79391ff9a8e3ce4a119" title="Returns the DB name for the MDL name of a module (or file path for MDLE modules). ...">get_db_module_name</a>(module_name.c_str()));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IModule&gt;</a> module(</div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IModule.html" title="This interface represents an MDL module. ">mi::neuraylib::IModule</a>&gt;(module_db_name-&gt;get_c_str()));</div>
<div class="line">    <span class="keywordflow">if</span> (!module)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to access the loaded module.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Attach the material name</span></div>
<div class="line">    std::string material_db_name</div>
<div class="line">        = std::string(module_db_name-&gt;get_c_str()) + <span class="stringliteral">&quot;::&quot;</span> + material_simple_name;</div>
<div class="line">    material_db_name = mi::examples::mdl::add_missing_material_signature(</div>
<div class="line">        module.get(), material_db_name);</div>
<div class="line">    <span class="keywordflow">if</span> (material_db_name.empty())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to find the material %s in the module %s.&quot;</span>,</div>
<div class="line">            material_simple_name.c_str(), module_name.c_str());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get the material definition from the database</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> material_definition(</div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(material_db_name.c_str()));</div>
<div class="line">    <span class="keywordflow">if</span> (!material_definition)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Accessing definition &#39;%s&#39; failed.&quot;</span>, material_db_name.c_str());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a material instance from the material definition with the default arguments.</span></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result;</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">        material_definition-&gt;create_function_call(0, &amp;result));</div>
<div class="line">    <span class="keywordflow">if</span> (result != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Instantiating &#39;%s&#39; failed.&quot;</span>, material_db_name.c_str());</div>
<div class="line"></div>
<div class="line">    transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#ae1c0cccf93ff990b7af8d0d0379f7c09" title="Stores the element db_element in the database under the name name and with the privacy level privacy...">store</a>(material_instance.get(), instance_name);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Compiles the given material instance in the given compilation modes and stores it in the DB.</span></div>
<div class="line"><span class="keywordtype">void</span> compile_material_instance(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html" title="The execution context can be used to query status information like error and warning messages concern...">mi::neuraylib::IMdl_execution_context</a>* context,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* instance_name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* compiled_material_name,</div>
<div class="line">    <span class="keywordtype">bool</span> class_compilation)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IMaterial_instance&gt;</a> material_instance(</div>
<div class="line">       transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMaterial__instance.html" title="This interface represents a material instance. ">mi::neuraylib::IMaterial_instance</a>&gt;(instance_name));</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> flags = class_compilation</div>
<div class="line">        ? <a class="code" href="classmi_1_1neuraylib_1_1IMaterial__instance.html#ab0b7608e59f1ad96b00a2fbb5cc2d959a7474d76ee055edda39a494edf06cfc36" title="Selects class compilation instead of instance compilation. ">mi::neuraylib::IMaterial_instance::CLASS_COMPILATION</a></div>
<div class="line">        : <a class="code" href="classmi_1_1neuraylib_1_1IMaterial__instance.html#ab0b7608e59f1ad96b00a2fbb5cc2d959afdcc06252ec8a89909ddd69006031766" title="Default compilation options (e.g., instance compilation). ">mi::neuraylib::IMaterial_instance::DEFAULT_OPTIONS</a>;</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ICompiled_material&gt;</a> compiled_material(</div>
<div class="line">        material_instance-&gt;create_compiled_material(flags, context));</div>
<div class="line">    check_success(print_messages(context));</div>
<div class="line"></div>
<div class="line">    transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#ae1c0cccf93ff990b7af8d0d0379f7c09" title="Stores the element db_element in the database under the name name and with the privacy level privacy...">store</a>(compiled_material.get(), compiled_material_name);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Generate and execute native CPU code for a subexpression of a given compiled material.</span></div>
<div class="line"><a class="code" href="classmi_1_1neuraylib_1_1ITarget__code.html" title="Represents target code of an MDL backend. ">mi::neuraylib::ITarget_code</a> <span class="keyword">const</span> *generate_native(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__backend__api.html" title="This interface can be used to obtain the MDL backends. ">mi::neuraylib::IMdl_backend_api</a>* mdl_backend_api,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html" title="The execution context can be used to query status information like error and warning messages concern...">mi::neuraylib::IMdl_execution_context</a>* context,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* compiled_material_name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* path,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* fname,</div>
<div class="line">    <span class="keywordtype">bool</span> use_custom_tex_runtime,</div>
<div class="line">    <span class="keywordtype">bool</span> enable_derivatives)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ICompiled_material&gt;</a> compiled_material(</div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1ICompiled__material.html" title="This interface represents a compiled material. ">mi::neuraylib::ICompiled_material</a>&gt;(compiled_material_name));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_backend&gt;</a> be_native(</div>
<div class="line">        mdl_backend_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__backend__api.html#a74baca56433d61f89de6b68019b6beb5" title="Returns an MDL backend generator. ">get_backend</a>(<a class="code" href="classmi_1_1neuraylib_1_1IMdl__backend__api.html#a28a914c7c51dd45974b16fa189a77b46a353b866fa7aac285667aded4b8dba94b" title="Generate native code. ">mi::neuraylib::IMdl_backend_api::MB_NATIVE</a>));</div>
<div class="line">    check_success(be_native-&gt;set_option(<span class="stringliteral">&quot;num_texture_spaces&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>) == 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (use_custom_tex_runtime)</div>
<div class="line">        check_success(be_native-&gt;set_option(<span class="stringliteral">&quot;use_builtin_resource_handler&quot;</span>, <span class="stringliteral">&quot;off&quot;</span>) == 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (enable_derivatives)</div>
<div class="line">        check_success(be_native-&gt;set_option(<span class="stringliteral">&quot;texture_runtime_with_derivs&quot;</span>, <span class="stringliteral">&quot;on&quot;</span>) == 0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Generate the native code</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ITarget_code&gt;</a> code_native(</div>
<div class="line">        be_native-&gt;translate_material_expression(</div>
<div class="line">            transaction, compiled_material.get(), path, fname, context));</div>
<div class="line">    check_success(print_messages(context));</div>
<div class="line">    check_success(code_native);</div>
<div class="line"></div>
<div class="line">    code_native-&gt;retain();</div>
<div class="line">    <span class="keywordflow">return</span> code_native.get();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Bake the material expression created with the native backend into a canvas with the given</span></div>
<div class="line"><span class="comment">// resolution.</span></div>
<div class="line"><a class="code" href="classmi_1_1neuraylib_1_1ICanvas.html" title="Abstract interface for a canvas represented by a rectangular array of tiles. ">mi::neuraylib::ICanvas</a> *bake_expression_native(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html" title="This interface provides various utilities related to canvases and buffers. ">mi::neuraylib::IImage_api</a>            *image_api,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITarget__code.html" title="Represents target code of an MDL backend. ">mi::neuraylib::ITarget_code</a> <span class="keyword">const</span>    *code_native,</div>
<div class="line">    <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a>  *tex_handler,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                            width,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                            height)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create a canvas (with only one tile)</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ICanvas&gt;</a> canvas(</div>
<div class="line">        image_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html#a4f776e1c0271e6898a3585c0bf8099cd" title="Creates a canvas with given pixel type, resolution, and layers. ">create_canvas</a>(<span class="stringliteral">&quot;Rgb_fp&quot;</span>, width, height));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Setup MDL material state (with only one texture space)</span></div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a>   texture_coords[1]    = { { 0.0f, 0.0f, 0.0f } };</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a>   texture_tangent_u[1] = { { 1.0f, 0.0f, 0.0f } };</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a>   texture_tangent_v[1] = { { 0.0f, 1.0f, 0.0f } };</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html" title="The MDL material state structure inside the MDL SDK is a representation of the renderer state as defi...">mi::neuraylib::Shading_state_material</a> mdl_state = {</div>
<div class="line">        <span class="comment">/*normal=*/</span>                { 0.0f, 0.0f, 1.0f },</div>
<div class="line">        <span class="comment">/*geom_normal=*/</span>           { 0.0f, 0.0f, 1.0f },</div>
<div class="line">        <span class="comment">/*position=*/</span>              { 0.0f, 0.0f, 0.0f },</div>
<div class="line">        <span class="comment">/*animation_time=*/</span>        0.0f,</div>
<div class="line">        <span class="comment">/*texture_coords=*/</span>        texture_coords,</div>
<div class="line">        <span class="comment">/*tangent_u=*/</span>             texture_tangent_u,</div>
<div class="line">        <span class="comment">/*tangent_v=*/</span>             texture_tangent_v,</div>
<div class="line">        <span class="comment">/*text_results=*/</span>          <span class="keyword">nullptr</span>,</div>
<div class="line">        <span class="comment">/*ro_data_segment=*/</span>       <span class="keyword">nullptr</span>,</div>
<div class="line">        <span class="comment">/*world_to_object=*/</span>       &amp;identity[0],</div>
<div class="line">        <span class="comment">/*object_to_world=*/</span>       &amp;identity[0],</div>
<div class="line">        <span class="comment">/*object_id=*/</span>             0,</div>
<div class="line">        <span class="comment">/*meters_per_scene_unit=*/</span> 1.0f</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Provide a large enough buffer for any result type.</span></div>
<div class="line">    <span class="comment">// In this case, we know, we will get a color which is a float3, so this is overkill.</span></div>
<div class="line">    <span class="keyword">union</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span>                     int_val;</div>
<div class="line">        <span class="keywordtype">float</span>                   float_val;</div>
<div class="line">        <span class="keywordtype">double</span>                  double_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a>    float3_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_4_struct</a>    float4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Matrix__struct.html" title="Storage class for a NxM-dimensional matrix class template of fixed dimensions. ">mi::Float32_4_4_struct</a>  float4x4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float64_3_struct</a>    double3_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float64_4_struct</a>    double4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Matrix__struct.html" title="Storage class for a NxM-dimensional matrix class template of fixed dimensions. ">mi::Float64_4_4_struct</a>  double4x4_val;</div>
<div class="line">    } execute_result = { 0 };</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Calculate all expression values for a 2x2 quad around the center of the world</span></div>
<div class="line">    <span class="comment">// and write them to the canvas.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ITile&gt;</a> tile(canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas.html#a2498f17d35d4e888a76bdc077df1a406" title="Returns the tile for the given layer. ">get_tile</a>());</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a> *data = <span class="keyword">static_cast&lt;</span><a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a> *<span class="keyword">&gt;</span>(tile-&gt;get_data());</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> y = 0; y &lt; height; ++y) {</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> x = 0; x &lt; width; ++x) {</div>
<div class="line">            <span class="comment">// Update state for the current pixel</span></div>
<div class="line">            <span class="keywordtype">float</span> rel_x = float(x) / float(width);</div>
<div class="line">            <span class="keywordtype">float</span> rel_y = float(y) / float(height);</div>
<div class="line">            mdl_state.<a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html#a2cfd2481510acbb6bd947dcfc3b1bcaa" title="The result of state::position(). ">position</a>.x = 2.0f * rel_x - 1;  <span class="comment">// [-1, 1)</span></div>
<div class="line">            mdl_state.<a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html#a2cfd2481510acbb6bd947dcfc3b1bcaa" title="The result of state::position(). ">position</a>.y = 2.0f * rel_y - 1;  <span class="comment">// [-1, 1)</span></div>
<div class="line">            texture_coords[0].x  = rel_x;             <span class="comment">// [0, 1)</span></div>
<div class="line">            texture_coords[0].y  = rel_y;             <span class="comment">// [0, 1)</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">// Evaluate sub-expression</span></div>
<div class="line">            check_success(</div>
<div class="line">                code_native-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga0d8a1db424af9c982185f001784441be" title="Run this code on the native CPU with the given captured arguments block. ">execute</a>(0, mdl_state, tex_handler, <span class="keyword">nullptr</span>, &amp;execute_result) == 0);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Apply gamma correction</span></div>
<div class="line">            execute_result.float3_val.x = powf(execute_result.float3_val.x, 1.f / 2.2f);</div>
<div class="line">            execute_result.float3_val.y = powf(execute_result.float3_val.y, 1.f / 2.2f);</div>
<div class="line">            execute_result.float3_val.z = powf(execute_result.float3_val.z, 1.f / 2.2f);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Store result in texture</span></div>
<div class="line">            data[y * width + x] = execute_result.float3_val;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    canvas-&gt;<a class="code" href="classmi_1_1base_1_1IInterface.html#a2c52e362969ee0f56ab5f8655937402f" title="Increments the reference count. ">retain</a>();</div>
<div class="line">    <span class="keywordflow">return</span> canvas.<a class="code" href="classmi_1_1base_1_1Handle.html#ab28423d4121459d4026449e4991f5486" title="Access to the interface. Returns 0 for an invalid interface. ">get</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Bake the material expression created with the native backend into a canvas with the given</span></div>
<div class="line"><span class="comment">// resolution with derivative support.</span></div>
<div class="line"><a class="code" href="classmi_1_1neuraylib_1_1ICanvas.html" title="Abstract interface for a canvas represented by a rectangular array of tiles. ">mi::neuraylib::ICanvas</a> *bake_expression_native_with_derivs(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html" title="This interface provides various utilities related to canvases and buffers. ">mi::neuraylib::IImage_api</a>                  *image_api,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITarget__code.html" title="Represents target code of an MDL backend. ">mi::neuraylib::ITarget_code</a> <span class="keyword">const</span>          *code_native,</div>
<div class="line">    <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__deriv__base.html" title="The texture handler structure that is passed to the texturing functions with derivative support...">mi::neuraylib::Texture_handler_deriv_base</a>  *tex_handler,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                                  width,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                                  height)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create a canvas</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ICanvas&gt;</a> canvas(</div>
<div class="line">        image_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html#a4f776e1c0271e6898a3585c0bf8099cd" title="Creates a canvas with given pixel type, resolution, and layers. ">create_canvas</a>(<span class="stringliteral">&quot;Rgb_fp&quot;</span>, width, height));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Setup MDL material state (with only one texture space)</span></div>
<div class="line">    <span class="keywordtype">float</span> step_x = 1.f / width;</div>
<div class="line">    <span class="keywordtype">float</span> step_y = 1.f / height;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga485e6f52995285582fc6a4b4be266e4e" title="A float3 with derivatives. ">mi::neuraylib::tct_deriv_float3</a> texture_coords[1] = {</div>
<div class="line">        {</div>
<div class="line">            { 0.0f, 0.0f, 0.0f },     <span class="comment">// value component</span></div>
<div class="line">            { step_x, 0.0f, 0.0f },   <span class="comment">// dx component</span></div>
<div class="line">            { 0.0f, step_y, 0.0f }    <span class="comment">// dy component</span></div>
<div class="line">        } };</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::neuraylib::tct_float3</a> texture_tangent_u[1] = { { 1.0f, 0.0f, 0.0f } };</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::neuraylib::tct_float3</a> texture_tangent_v[1] = { { 0.0f, 1.0f, 0.0f } };</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html" title="The MDL material state structure inside the MDL SDK is a representation of the renderer state as defi...">mi::neuraylib::Shading_state_material_with_derivs</a> mdl_state = {</div>
<div class="line">        <span class="comment">/*normal=*/</span>                { 0.0f, 0.0f, 1.0f },</div>
<div class="line">        <span class="comment">/*geom_normal=*/</span>           { 0.0f, 0.0f, 1.0f },</div>
<div class="line">        <span class="comment">/*position=*/</span></div>
<div class="line">        {</div>
<div class="line">            { 0.0f, 0.0f, 0.0f },         <span class="comment">// value component</span></div>
<div class="line">            { 2 * step_x, 0.0f, 0.0f },   <span class="comment">// dx component</span></div>
<div class="line">            { 0.0f, 2 * step_y, 0.0f }    <span class="comment">// dy component</span></div>
<div class="line">        },</div>
<div class="line">        <span class="comment">/*animation_time=*/</span>        0.0f,</div>
<div class="line">        <span class="comment">/*texture_coords=*/</span>        texture_coords,</div>
<div class="line">        <span class="comment">/*tangent_u=*/</span>             texture_tangent_u,</div>
<div class="line">        <span class="comment">/*tangent_v=*/</span>             texture_tangent_v,</div>
<div class="line">        <span class="comment">/*text_results=*/</span>          <span class="keyword">nullptr</span>,</div>
<div class="line">        <span class="comment">/*ro_data_segment=*/</span>       <span class="keyword">nullptr</span>,</div>
<div class="line">        <span class="comment">/*world_to_object=*/</span>       &amp;identity[0],</div>
<div class="line">        <span class="comment">/*object_to_world=*/</span>       &amp;identity[0],</div>
<div class="line">        <span class="comment">/*object_id=*/</span>             0,</div>
<div class="line">        <span class="comment">/*meters_per_scene_unit=*/</span> 1.0f</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Provide a large enough buffer for any result type.</span></div>
<div class="line">    <span class="comment">// In this case, we know, we will get a color which is a float3, so this is overkill.</span></div>
<div class="line">    <span class="keyword">union</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span>                     int_val;</div>
<div class="line">        <span class="keywordtype">float</span>                   float_val;</div>
<div class="line">        <span class="keywordtype">double</span>                  double_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a>    float3_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_4_struct</a>    float4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Matrix__struct.html" title="Storage class for a NxM-dimensional matrix class template of fixed dimensions. ">mi::Float32_4_4_struct</a>  float4x4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float64_3_struct</a>    double3_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float64_4_struct</a>    double4_val;</div>
<div class="line">        <a class="code" href="structmi_1_1math_1_1Matrix__struct.html" title="Storage class for a NxM-dimensional matrix class template of fixed dimensions. ">mi::Float64_4_4_struct</a>  double4x4_val;</div>
<div class="line">    } execute_result = { 0 };</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Calculate all expression values for a 2x2 quad around the center of the world</span></div>
<div class="line">    <span class="comment">// and write them to the canvas.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ITile&gt;</a> tile(canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas.html#a2498f17d35d4e888a76bdc077df1a406" title="Returns the tile for the given layer. ">get_tile</a>());</div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a> *data = <span class="keyword">static_cast&lt;</span><a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_3_struct</a> *<span class="keyword">&gt;</span>(tile-&gt;get_data());</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> y = 0; y &lt; height; ++y) {</div>
<div class="line">        <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> x = 0; x &lt; width; ++x) {</div>
<div class="line">            <span class="comment">// Update state for the current pixel</span></div>
<div class="line">            <span class="keywordtype">float</span> rel_x = x * step_x;</div>
<div class="line">            <span class="keywordtype">float</span> rel_y = y * step_y;</div>
<div class="line">            mdl_state.<a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html#a2cfd2481510acbb6bd947dcfc3b1bcaa" title="The result of state::position(). ">position</a>.val.x = 2.0f * rel_x - 1;  <span class="comment">// [-1, 1)</span></div>
<div class="line">            mdl_state.<a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html#a2cfd2481510acbb6bd947dcfc3b1bcaa" title="The result of state::position(). ">position</a>.val.y = 2.0f * rel_y - 1;  <span class="comment">// [-1, 1)</span></div>
<div class="line">            texture_coords[0].val.x  = rel_x;             <span class="comment">// [0, 1)</span></div>
<div class="line">            texture_coords[0].val.y  = rel_y;             <span class="comment">// [0, 1)</span></div>
<div class="line"></div>
<div class="line">            <span class="comment">// Evaluate sub-expression</span></div>
<div class="line">            check_success(code_native-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga0d8a1db424af9c982185f001784441be" title="Run this code on the native CPU with the given captured arguments block. ">execute</a>(</div>
<div class="line">                0,</div>
<div class="line">                reinterpret_cast&lt;mi::neuraylib::Shading_state_material &amp;&gt;(mdl_state),</div>
<div class="line">                reinterpret_cast&lt;mi::neuraylib::Texture_handler_base *&gt;(tex_handler),</div>
<div class="line">                <span class="keyword">nullptr</span>,</div>
<div class="line">                &amp;execute_result) == 0);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Apply gamma correction</span></div>
<div class="line">            execute_result.float3_val.x = powf(execute_result.float3_val.x, 1.f / 2.2f);</div>
<div class="line">            execute_result.float3_val.y = powf(execute_result.float3_val.y, 1.f / 2.2f);</div>
<div class="line">            execute_result.float3_val.z = powf(execute_result.float3_val.z, 1.f / 2.2f);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Store result in texture</span></div>
<div class="line">            data[y * width + x] = execute_result.float3_val;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    canvas-&gt;<a class="code" href="classmi_1_1base_1_1IInterface.html#a2c52e362969ee0f56ab5f8655937402f" title="Increments the reference count. ">retain</a>();</div>
<div class="line">    <span class="keywordflow">return</span> canvas.<a class="code" href="classmi_1_1base_1_1Handle.html#ab28423d4121459d4026449e4991f5486" title="Access to the interface. Returns 0 for an invalid interface. ">get</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Prepare the textures for our own texture runtime.</span></div>
<div class="line"><span class="keywordtype">bool</span> prepare_textures(</div>
<div class="line">    std::vector&lt;Texture&gt;&amp; textures,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html" title="This interface provides various utilities related to canvases and buffers. ">mi::neuraylib::IImage_api</a>* image_api,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1neuraylib_1_1ITarget__code.html" title="Represents target code of an MDL backend. ">mi::neuraylib::ITarget_code</a>* target_code)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> i = 1 <span class="comment">/*skip invalid texture*/</span>; i &lt; target_code-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga5d379f3e8619bd43bfbe569c0490949a" title="Returns the number of texture resources used by the target code. ">get_texture_count</a>(); ++i)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ITexture&gt;</a> texture(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<span class="keyword">const</span> <a class="code" href="classmi_1_1neuraylib_1_1ITexture.html" title="Textures add image processing options to images. ">mi::neuraylib::ITexture</a>&gt;(</div>
<div class="line">                target_code-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga9981716cff2ab0dada7d3b5288c9afb4" title="Returns the name of a texture resource used by the target code. ">get_texture</a>(i)));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IImage&gt;</a> image(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IImage.html" title="This interface represents a pixel image file. ">mi::neuraylib::IImage</a>&gt;(texture-&gt;get_image()));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ICanvas&gt;</a> canvas(image-&gt;get_canvas(0, 0, 0));</div>
<div class="line">        <span class="keywordtype">char</span> <span class="keyword">const</span> *image_type = image-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas__base.html#ab36d6bebb85da08e907eadbe7542c658" title="Returns the pixel type used by the canvas. ">get_type</a>(0, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (image-&gt;is_uvtile() || image-&gt;is_animated()) {</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;The example does not support uvtile and/or animated textures!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">// For simplicity, the texture access functions are only implemented for float4 and gamma</span></div>
<div class="line">        <span class="comment">// is pre-applied here (all images are converted to linear space).</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// Convert to linear color space if necessary</span></div>
<div class="line">        <span class="keywordflow">if</span> (texture-&gt;get_effective_gamma(0, 0) != 1.0f) {</div>
<div class="line">            <span class="comment">// Copy/convert to float4 canvas and adjust gamma from &quot;effective gamma&quot; to 1.</span></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ICanvas&gt;</a> gamma_canvas(</div>
<div class="line">                image_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html#a70bb55d4f633151d12664b078ddd6ebb" title="Converts a canvas to a different pixel type. ">convert</a>(canvas.<a class="code" href="classmi_1_1base_1_1Handle.html#ab28423d4121459d4026449e4991f5486" title="Access to the interface. Returns 0 for an invalid interface. ">get</a>(), <span class="stringliteral">&quot;Color&quot;</span>));</div>
<div class="line">            gamma_canvas-&gt;set_gamma(texture-&gt;get_effective_gamma(0, 0));</div>
<div class="line">            image_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html#aef6f6c7994c60410b14d45a6cd0af7ce" title="Sets the gamma value of a canvas and adjusts the pixel data accordingly. ">adjust_gamma</a>(gamma_canvas.get(), 1.0f);</div>
<div class="line">            canvas = gamma_canvas;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(image_type, <span class="stringliteral">&quot;Color&quot;</span>) != 0 &amp;&amp; strcmp(image_type, <span class="stringliteral">&quot;Float32&lt;4&gt;&quot;</span>) != 0) {</div>
<div class="line">            <span class="comment">// Convert to expected format</span></div>
<div class="line">            canvas = image_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html#a70bb55d4f633151d12664b078ddd6ebb" title="Converts a canvas to a different pixel type. ">convert</a>(canvas.<a class="code" href="classmi_1_1base_1_1Handle.html#ab28423d4121459d4026449e4991f5486" title="Access to the interface. Returns 0 for an invalid interface. ">get</a>(), <span class="stringliteral">&quot;Color&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        textures.push_back(Texture(canvas));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Print command line usage to console and terminate the application.</span></div>
<div class="line"><span class="keywordtype">void</span> usage(<span class="keywordtype">char</span> <span class="keyword">const</span> *prog_name)</div>
<div class="line">{</div>
<div class="line">    std::cout</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; prog_name &lt;&lt; <span class="stringliteral">&quot; [options] [&lt;material_name&gt;]\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Options:\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  --res &lt;x&gt; &lt;y&gt;       resolution (default: 700x520)\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  --cc                use class compilation\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  --cr                use custom texture runtime\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  -d                  enable use of derivatives\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;                      (not supported in combination with --cr by this example)\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  -o &lt;outputfile&gt;     image file to write result to\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;                      (default: example_native.png)\n&quot;</span></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;  --mdl_path &lt;path&gt;   mdl search path, can occur multiple times.&quot;</span></div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line">    exit_failure();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Main function</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><span class="keywordtype">int</span> MAIN_UTF8(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Parse command line options</span></div>
<div class="line">    Options options;</div>
<div class="line">    mi::examples::mdl::Configure_options configure_options;</div>
<div class="line">    configure_options.add_example_search_path = <span class="keyword">false</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; argc; ++i) {</div>
<div class="line">        <span class="keywordtype">char</span> <span class="keyword">const</span> *opt = argv[i];</div>
<div class="line">        <span class="keywordflow">if</span> (opt[0] == <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;-o&quot;</span>) == 0 &amp;&amp; i &lt; argc - 1) {</div>
<div class="line">                options.outputfile = argv[++i];</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;--res&quot;</span>) == 0 &amp;&amp; i &lt; argc - 2) {</div>
<div class="line">                options.res_x = std::max(atoi(argv[++i]), 1);</div>
<div class="line">                options.res_y = std::max(atoi(argv[++i]), 1);</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;--cc&quot;</span>) == 0) {</div>
<div class="line">                options.use_class_compilation = <span class="keyword">true</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;--cr&quot;</span>) == 0) {</div>
<div class="line">                options.use_custom_tex_runtime = <span class="keyword">true</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;-d&quot;</span>) == 0) {</div>
<div class="line">                options.enable_derivatives = <span class="keyword">true</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(opt, <span class="stringliteral">&quot;--mdl_path&quot;</span>) == 0 &amp;&amp; i &lt; argc - 1) {</div>
<div class="line">                configure_options.additional_mdl_paths.push_back(argv[++i]);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                std::cout &lt;&lt; <span class="stringliteral">&quot;Unknown option: \&quot;&quot;</span> &lt;&lt; opt &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">                usage(argv[0]);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">            options.material_name = opt;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Use default material, if none was provided via command line</span></div>
<div class="line">    <span class="keywordflow">if</span> (options.material_name.empty()) {</div>
<div class="line">        configure_options.add_example_search_path = <span class="keyword">true</span>;</div>
<div class="line">        options.material_name = <span class="stringliteral">&quot;::nvidia::sdk_examples::tutorials::example_execution1&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Access the MDL SDK</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::INeuray&gt;</a> neuray(mi::examples::mdl::load_and_get_ineuray());</div>
<div class="line">    <span class="keywordflow">if</span> (!neuray.is_valid_interface())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to load the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Configure the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::configure(neuray.get(), configure_options))</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start the MDL SDK</span></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> ret = neuray-&gt;start();</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK. Result code: %d&quot;</span>, ret);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Create a transaction</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IDatabase&gt;</a> database(</div>
<div class="line">            neuray-&gt;get_api_component&lt;<a class="code" href="classmi_1_1neuraylib_1_1IDatabase.html" title="This interface is used to interact with the distributed database. ">mi::neuraylib::IDatabase</a>&gt;());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IScope&gt;</a> scope(database-&gt;get_global_scope());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::ITransaction&gt;</a> transaction(scope-&gt;create_transaction());</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IMdl_factory&gt;</a> mdl_factory(</div>
<div class="line">                neuray-&gt;get_api_component&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>&gt;());</div>
<div class="line"></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_impexp_api&gt;</a> mdl_impexp_api(</div>
<div class="line">                neuray-&gt;get_api_component&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html" title="API component for MDL related import and export operations. ">mi::neuraylib::IMdl_impexp_api</a>&gt;());</div>
<div class="line"></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_backend_api&gt;</a> mdl_backend_api(</div>
<div class="line">                neuray-&gt;get_api_component&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__backend__api.html" title="This interface can be used to obtain the MDL backends. ">mi::neuraylib::IMdl_backend_api</a>&gt;());</div>
<div class="line"></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_execution_context&gt;</a> context(</div>
<div class="line">                mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a78a9a6489592c90ea49e0fe0ac8be235" title="Creates an execution context. ">create_execution_context</a>());</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Load the MDL module and create a material instance</span></div>
<div class="line">            std::string instance_name = <span class="stringliteral">&quot;material instance&quot;</span>;</div>
<div class="line">            create_material_instance(</div>
<div class="line">                mdl_factory.get(),</div>
<div class="line">                transaction.get(),</div>
<div class="line">                mdl_impexp_api.get(),</div>
<div class="line">                context.get(),</div>
<div class="line">                options.material_name.c_str(),</div>
<div class="line">                instance_name.c_str());</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Compile the material instance in instance compilation mode</span></div>
<div class="line">            std::string instance_compilation_name</div>
<div class="line">                = std::string(<span class="stringliteral">&quot;instance compilation of &quot;</span>) + instance_name;</div>
<div class="line">            <span class="comment">// Compile the material instance</span></div>
<div class="line">            std::string compilation_name</div>
<div class="line">                = std::string(<span class="stringliteral">&quot;compilation of &quot;</span>) + instance_name;</div>
<div class="line">            compile_material_instance(</div>
<div class="line">                transaction.get(),</div>
<div class="line">                context.get(),</div>
<div class="line">                instance_name.c_str(),</div>
<div class="line">                compilation_name.c_str(),</div>
<div class="line">                options.use_class_compilation);</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Generate target code for some material expression</span></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ITarget_code&gt;</a> target_code(</div>
<div class="line">                generate_native(</div>
<div class="line">                    transaction.get(),</div>
<div class="line">                    mdl_backend_api.get(),</div>
<div class="line">                    context.get(),</div>
<div class="line">                    compilation_name.c_str(),</div>
<div class="line">                    <span class="stringliteral">&quot;surface.scattering.tint&quot;</span>,            <span class="comment">// MDL expression path</span></div>
<div class="line">                    <span class="stringliteral">&quot;tint&quot;</span>,                               <span class="comment">// name of generated function</span></div>
<div class="line">                    options.use_custom_tex_runtime,</div>
<div class="line">                    options.enable_derivatives));</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Acquire image API needed to create a canvas for baking</span></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IImage_api&gt;</a> image_api(</div>
<div class="line">                neuray-&gt;get_api_component&lt;<a class="code" href="classmi_1_1neuraylib_1_1IImage__api.html" title="This interface provides various utilities related to canvases and buffers. ">mi::neuraylib::IImage_api</a>&gt;());</div>
<div class="line"></div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ICanvas&gt;</a> canvas;</div>
<div class="line"></div>
<div class="line">            std::vector&lt;Texture&gt;  textures;</div>
<div class="line">            <span class="keywordflow">if</span> (options.use_custom_tex_runtime) {</div>
<div class="line">                <span class="comment">// Setup custom texture handler</span></div>
<div class="line">                check_success(prepare_textures(</div>
<div class="line">                    textures, transaction.get(), image_api.get(), target_code.get()));</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Bake the expression into a canvas</span></div>
<div class="line">            <span class="keywordflow">if</span> (options.enable_derivatives) {</div>
<div class="line">                Texture_handler_deriv tex_handler;</div>
<div class="line">                Texture_handler_deriv *tex_handler_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line">                <span class="keywordflow">if</span> (options.use_custom_tex_runtime) {</div>
<div class="line">                    tex_handler.vtable = &amp;tex_deriv_vtable;</div>
<div class="line">                    tex_handler.num_textures = target_code-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga5d379f3e8619bd43bfbe569c0490949a" title="Returns the number of texture resources used by the target code. ">get_texture_count</a>() - 1;</div>
<div class="line">                    tex_handler.textures = textures.data();</div>
<div class="line"></div>
<div class="line">                    tex_handler_ptr = &amp;tex_handler;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                canvas = bake_expression_native_with_derivs(</div>
<div class="line">                    image_api.get(), target_code.get(), tex_handler_ptr,</div>
<div class="line">                    options.res_x, options.res_y);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                Texture_handler tex_handler;</div>
<div class="line">                Texture_handler *tex_handler_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line">                <span class="keywordflow">if</span> (options.use_custom_tex_runtime) {</div>
<div class="line">                    tex_handler.vtable = &amp;tex_vtable;</div>
<div class="line">                    tex_handler.num_textures = target_code-&gt;<a class="code" href="group__mi__neuray__mdl__compiler.html#ga5d379f3e8619bd43bfbe569c0490949a" title="Returns the number of texture resources used by the target code. ">get_texture_count</a>() - 1;</div>
<div class="line">                    tex_handler.textures = textures.data();</div>
<div class="line"></div>
<div class="line">                    tex_handler_ptr = &amp;tex_handler;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                canvas = bake_expression_native(</div>
<div class="line">                    image_api.get(), target_code.get(), tex_handler_ptr,</div>
<div class="line">                    options.res_x, options.res_y);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Export the canvas to an image on disk</span></div>
<div class="line">            mdl_impexp_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html#a1b544c77874b97eae0003c39e27e2103" title="Exports a canvas to a file on disk. ">export_canvas</a>(options.outputfile.c_str(), canvas.<a class="code" href="classmi_1_1base_1_1Handle.html#ab28423d4121459d4026449e4991f5486" title="Access to the interface. Returns 0 for an invalid interface. ">get</a>());</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#aa4ff8152107db238986b364273bceb0c" title="Commits the transaction. ">commit</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Shut down the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (neuray-&gt;shutdown() != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to shutdown the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Unload the MDL SDK</span></div>
<div class="line">    neuray = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::unload())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to unload the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    exit_success();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Convert command line arguments to UTF8 on Windows</span></div>
<div class="line">COMMANDLINE_TO_UTF8</div>
</div><!-- fragment --><p><b>Source Code Location:</b> <code>examples/mdl_sdk/shared/texture_support_native.h</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// This file contains the implementations and the vtable of the texture access functions.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef TEXTURE_SUPPORT_H</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define TEXTURE_SUPPORT_H</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &quot;example_shared.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define USE_SMOOTHERSTEP_FILTER</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga69137bb7a93d941a5a8578ca4c772fbf" title="A float with derivatives. ">mi::neuraylib::tct_deriv_float</a>                     <a class="code" href="group__mi__neuray__mdl__compiler.html#ga69137bb7a93d941a5a8578ca4c772fbf" title="A float with derivatives. ">tct_deriv_float</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga067809015fbce254f57a2d1de28a7a14" title="A float2 with derivatives. ">mi::neuraylib::tct_deriv_float2</a>                    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga067809015fbce254f57a2d1de28a7a14" title="A float2 with derivatives. ">tct_deriv_float2</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1tct__deriv.html" title="A template struct with derivatives. ">mi::neuraylib::tct_deriv_arr_float_2</a>               <a class="code" href="group__mi__neuray__mdl__compiler.html#ga955d747a7ae62b5e18e9f4359743136d" title="A float[2] with derivatives (needed to avoid problems with wrong alignment). ">tct_deriv_arr_float_2</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1tct__deriv.html" title="A template struct with derivatives. ">mi::neuraylib::tct_deriv_arr_float_3</a>               <a class="code" href="group__mi__neuray__mdl__compiler.html#gac1f3572aefe12967db565ec2b2dc0a07" title="A float[3] with derivatives (needed to avoid problems with wrong alignment). ">tct_deriv_arr_float_3</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1tct__deriv.html" title="A template struct with derivatives. ">mi::neuraylib::tct_deriv_arr_float_4</a>               <a class="code" href="group__mi__neuray__mdl__compiler.html#ga4213c9623560d5dc3839c8c6ebb097ac" title="A float[4] with derivatives (needed to avoid problems with wrong alignment). ">tct_deriv_arr_float_4</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html" title="The MDL material state structure inside the MDL SDK is a representation of the renderer state as defi...">mi::neuraylib::Shading_state_material_with_derivs</a>  <a class="code" href="group__mi__neuray__mdl__compiler.html#ga8ffb20982d3063f617cb7fbeccdf7f36" title="The MDL material state structure with derivatives for the texture coordinates. ">Shading_state_material_with_derivs</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1Shading__state__material__impl.html" title="The MDL material state structure inside the MDL SDK is a representation of the renderer state as defi...">mi::neuraylib::Shading_state_material</a>              <a class="code" href="group__mi__neuray__mdl__compiler.html#ga8a42cb80b6772ce4b266f2311b0561c1" title="The MDL material state structure. ">Shading_state_material</a>;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a>                Texture_handler_base;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__deriv__base.html" title="The texture handler structure that is passed to the texturing functions with derivative support...">mi::neuraylib::Texture_handler_deriv_base</a>          Texture_handler_deriv_base;</div>
<div class="line"><span class="keyword">typedef</span> <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a>                       <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">Tex_wrap_mode</a>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Custom structure representing an MDL texture</span></div>
<div class="line"><span class="keyword">struct </span>Texture</div>
<div class="line">{</div>
<div class="line">    Texture(<a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ICanvas&gt;</a> c)</div>
<div class="line">        : canvas(c)</div>
<div class="line">        , ncomp(4)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// for now, we only support floating point rgba</span></div>
<div class="line">        check_success(strcmp(canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas__base.html#ab36d6bebb85da08e907eadbe7542c658" title="Returns the pixel type used by the canvas. ">get_type</a>(), <span class="stringliteral">&quot;Color&quot;</span>) == 0);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle &lt; const mi::neuraylib::ITile&gt;</a> tile(canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas.html#a2498f17d35d4e888a76bdc077df1a406" title="Returns the tile for the given layer. ">get_tile</a>());</div>
<div class="line"></div>
<div class="line">        size.x = canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas__base.html#acd28f45b9d22b1cd1e24043aeda5c065" title="Returns the resolution of the canvas in x direction. ">get_resolution_x</a>();</div>
<div class="line">        size.y = canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas__base.html#a51874ccdb54f6e03ff325b01d98dfefb" title="Returns the resolution of the canvas in y direction. ">get_resolution_y</a>();</div>
<div class="line">        size.z = canvas-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ICanvas__base.html#a1d62d69c848f7b4da053bac9e071bb75" title="Returns the number of layers this canvas has. ">get_layers_size</a>();</div>
<div class="line"></div>
<div class="line">        data = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>*<span class="keyword">&gt;</span> (tile-&gt;get_data());</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::ICanvas&gt;</a> canvas;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> <span class="keyword">const</span>       *data;  <span class="comment">// texture data for fast access</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Uint32_3_struct</a>     size;   <span class="comment">// size of the texture</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>              ncomp;  <span class="comment">// components per pixel</span></div>
<div class="line"></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// The texture handler structure required by the MDL SDK with custom additional fields.</span></div>
<div class="line"><span class="keyword">struct </span>Texture_handler : Texture_handler_base {</div>
<div class="line">    <span class="comment">// additional data for the texture access functions can be provided here</span></div>
<div class="line">    <span class="keywordtype">size_t</span>         num_textures;       <span class="comment">// the number of textures used by the material</span></div>
<div class="line">                                       <span class="comment">// (without the invalid texture)</span></div>
<div class="line">    Texture <span class="keyword">const</span> *textures;           <span class="comment">// the textures used by the material</span></div>
<div class="line">                                       <span class="comment">// (without the invalid texture)</span></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// The texture handler structure required by the MDL SDK with custom additional fields.</span></div>
<div class="line"><span class="keyword">struct </span>Texture_handler_deriv : Texture_handler_deriv_base {</div>
<div class="line">    <span class="comment">// additional data for the texture access functions can be provided here</span></div>
<div class="line">    <span class="keywordtype">size_t</span>         num_textures;       <span class="comment">// the number of textures used by the material</span></div>
<div class="line">                                       <span class="comment">// (without the invalid texture)</span></div>
<div class="line">    Texture <span class="keyword">const</span> *textures;           <span class="comment">// the textures used by the material</span></div>
<div class="line">                                       <span class="comment">// (without the invalid texture)</span></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores a float4 in a float[4] array.</span></div>
<div class="line"><span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> store_result4(<span class="keywordtype">float</span> res[4], <span class="keyword">const</span> <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_4_struct</a> &amp;v)</div>
<div class="line">{</div>
<div class="line">    res[0] = v.x;</div>
<div class="line">    res[1] = v.y;</div>
<div class="line">    res[2] = v.z;</div>
<div class="line">    res[3] = v.w;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores a float in all elements of a float[4] array.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> store_result4(<span class="keywordtype">float</span> res[4], <span class="keyword">const</span> <span class="keywordtype">float</span> v)</div>
<div class="line">{</div>
<div class="line">    res[0] = res[1] = res[2] = res[3] = v;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores the given float values in a float[4] array.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> store_result4(</div>
<div class="line">    <span class="keywordtype">float</span> res[4], <span class="keyword">const</span> <span class="keywordtype">float</span> v0, <span class="keyword">const</span> <span class="keywordtype">float</span> v1, <span class="keyword">const</span> <span class="keywordtype">float</span> v2, <span class="keyword">const</span> <span class="keywordtype">float</span> v3)</div>
<div class="line">{</div>
<div class="line">    res[0] = v0;</div>
<div class="line">    res[1] = v1;</div>
<div class="line">    res[2] = v2;</div>
<div class="line">    res[3] = v3;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores a float4 in a float[3] array, ignoring v.w.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> store_result3(<span class="keywordtype">float</span> res[3], <span class="keyword">const</span> <a class="code" href="structmi_1_1math_1_1Vector__struct.html" title="Generic storage class template for math vector representations storing DIM elements of type T...">mi::Float32_4_struct</a> &amp;v)</div>
<div class="line">{</div>
<div class="line">    res[0] = v.x;</div>
<div class="line">    res[1] = v.y;</div>
<div class="line">    res[2] = v.z;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores a float in all elements of a float[3] array.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> store_result3(<span class="keywordtype">float</span> res[3], <span class="keyword">const</span> <span class="keywordtype">float</span> v)</div>
<div class="line">{</div>
<div class="line">    res[0] = res[1] = res[2] = v;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Stores the given float values in a float[3] array.</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> store_result3(<span class="keywordtype">float</span> res[3], <span class="keyword">const</span> <span class="keywordtype">float</span> v0, <span class="keyword">const</span> <span class="keywordtype">float</span> v1, <span class="keyword">const</span> <span class="keywordtype">float</span> v2)</div>
<div class="line">{</div>
<div class="line">    res[0] = v0;</div>
<div class="line">    res[1] = v1;</div>
<div class="line">    res[2] = v2;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Textures</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> u2f_rn(<span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> u) {</div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>) u;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> f2u_rz(<span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> f) {</div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>) f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a> f2ll_rz(<span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> f) {</div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a>) f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a> f2ll_rd(<span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> f) {</div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a>) <a class="code" href="group__mi__math__color.html#gaa9adff4429f68a195a799aec985d5ca1" title="Returns a color with the elementwise largest integral value that is not greater than the element in c...">mi::math::floor</a>(f);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texremap(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> tex_size, Tex_wrap_mode wrap_mode, <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> crop_offset, <span class="keywordtype">float</span> texf)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> texi = 0;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a> texil = f2ll_rz(texf);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a> texsizel = <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a>(tex_size);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__mi__base__types.html#ga0fa224a3412658ae9c96d7fe44428a7e" title="64-bit unsigned integer. ">mi::Uint64</a>(f2ll_rd(texf)) &gt;= <a class="code" href="group__mi__base__types.html#ga0fa224a3412658ae9c96d7fe44428a7e" title="64-bit unsigned integer. ">mi::Uint64</a>(tex_size)) {</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Wrap or clamp</span></div>
<div class="line">        <span class="keywordflow">if</span> (wrap_mode == <a class="code" href="group__mi__neuray__mdl__compiler.html#gga852d194e585ada01cc272e85e367ca9bae869e29ec201274360e57e9a2c862b59" title="tex::wrap_clamp: clamps the lookup coordinate to the range ">Tex_wrap_mode::TEX_WRAP_CLAMP</a> || wrap_mode == <a class="code" href="group__mi__neuray__mdl__compiler.html#gga852d194e585ada01cc272e85e367ca9ba846c76bb19179e518d0edc978f8bbe82" title="tex::wrap_clip: makes the texture lookup return zero for texture coordinates outside of the range ...">Tex_wrap_mode::TEX_WRAP_CLIP</a>)</div>
<div class="line">            texi = (int) std::min(std::max(texil, 0ll), (texsizel - 1ll));</div>
<div class="line">        <span class="comment">// Repeat</span></div>
<div class="line">        <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">            texi = <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a>(texil % texsizel);</div>
<div class="line"></div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> s = <a class="code" href="group__mi__math__function.html#gab47c198a0dff64d6124617930bf8383a" title="Returns true if s&lt;0 and false if s&gt;= 0. ">mi::math::sign_bit</a>(texf);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a> d = texil / (<a class="code" href="group__mi__base__types.html#ga09bc2ac56b82fa59928f2b8eff415457" title="64-bit signed integer. ">mi::Sint64</a>) tex_size;</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> a =</div>
<div class="line">                (<a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a>) (wrap_mode == <a class="code" href="group__mi__neuray__mdl__compiler.html#gga852d194e585ada01cc272e85e367ca9baba748feeb50ac63cacb01796e1df0a21" title="tex::wrap_mirrored_repeat: like wrap_repeat but takes one minus the fractional part every other inter...">Tex_wrap_mode::TEX_WRAP_MIRRORED_REPEAT</a>) &amp;</div>
<div class="line">                ((<a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a>) d^s) &amp; 1;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">bool</span> alternate = (a != 0);</div>
<div class="line">            <span class="keywordflow">if</span> (alternate)   <span class="comment">// Flip negative tex</span></div>
<div class="line">                texi = -texi;</div>
<div class="line">            <span class="keywordflow">if</span> (s != a) <span class="comment">// &quot;Otherwise&quot; pad negative tex back to positive</span></div>
<div class="line">                texi += (<a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a>) tex_size - 1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> texi = (int) texil;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Crop</span></div>
<div class="line">    texi += crop_offset;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>(texi);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup2D(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>                   res[4],</div>
<div class="line">    Texture <span class="keyword">const</span>                 &amp;tex,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>             uv[2],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a>  wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a>  wrap_v,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>             crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>             crop_v[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>                   frame)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_w = crop_u[1] - crop_u[0];</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_h = crop_v[1] - crop_v[0];</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Sint32_2</a> crop_offset(</div>
<div class="line">        f2u_rz(u2f_rn(tex.size.x-1) * crop_u[0]),</div>
<div class="line">        f2u_rz(u2f_rn(tex.size.y-1) * crop_v[0]));</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Uint32_2</a> crop_texres(</div>
<div class="line">        std::max(f2u_rz(u2f_rn(tex.size.x) * crop_w), 1u),</div>
<div class="line">        std::max(f2u_rz(u2f_rn(tex.size.y) * crop_h), 1u));</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span> U = uv[0] * crop_texres.x - 0.5f;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span> V = uv[1] * crop_texres.y - 0.5f;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> U0 = texremap(crop_texres.x, wrap_u, crop_offset[0], U);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> U1 = texremap(crop_texres.x, wrap_u, crop_offset[0], U+1.0f);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> V0 = texremap(crop_texres.y, wrap_v, crop_offset[1], V);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> V1 = texremap(crop_texres.y, wrap_v, crop_offset[1], V+1.0f);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> i00 = (tex.size.x * V0 + U0) * tex.ncomp;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> i01 = (tex.size.x * V0 + U1) * tex.ncomp;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> i10 = (tex.size.x * V1 + U0) * tex.ncomp;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> i11 = (tex.size.x * V1 + U1) * tex.ncomp;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> ufrac = U - <a class="code" href="group__mi__math__color.html#gaa9adff4429f68a195a799aec985d5ca1" title="Returns a color with the elementwise largest integral value that is not greater than the element in c...">mi::math::floor</a>(U);</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> vfrac = V - <a class="code" href="group__mi__math__color.html#gaa9adff4429f68a195a799aec985d5ca1" title="Returns a color with the elementwise largest integral value that is not greater than the element in c...">mi::math::floor</a>(V);</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef USE_SMOOTHERSTEP_FILTER</span></div>
<div class="line"><span class="preprocessor"></span>    ufrac *= ufrac*ufrac*(ufrac*(ufrac*6.0f - 15.0f) + 10.0f); <span class="comment">// smoother step</span></div>
<div class="line">    vfrac *= vfrac*vfrac*(vfrac*(vfrac*6.0f - 15.0f) + 10.0f);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a> c1 = <a class="code" href="group__mi__math__bbox.html#ga4f86bf3f9bf33c4450246611e30fd0d3" title="Returns the linear interpolation between bbox1 and bbox2, i.e., it returns (1-t) * bbox1 + t * bbox2...">mi::math::lerp</a>(</div>
<div class="line">        <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a>(tex.data[i00 + 0], tex.data[i00 + 1], tex.data[i00 + 2], tex.data[i00 + 3]),</div>
<div class="line">        <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a>(tex.data[i01 + 0], tex.data[i01 + 1], tex.data[i01 + 2], tex.data[i01 + 3]),</div>
<div class="line">        ufrac);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a> c2 = <a class="code" href="group__mi__math__bbox.html#ga4f86bf3f9bf33c4450246611e30fd0d3" title="Returns the linear interpolation between bbox1 and bbox2, i.e., it returns (1-t) * bbox1 + t * bbox2...">mi::math::lerp</a>(</div>
<div class="line">        <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a>(tex.data[i10 + 0], tex.data[i10 + 1], tex.data[i10 + 2], tex.data[i10 + 3]),</div>
<div class="line">        <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a>(tex.data[i11 + 0], tex.data[i11 + 1], tex.data[i11 + 2], tex.data[i11 + 3]),</div>
<div class="line">        ufrac);</div>
<div class="line"></div>
<div class="line">    store_result4(res, <a class="code" href="group__mi__math__bbox.html#ga4f86bf3f9bf33c4450246611e30fd0d3" title="Returns the linear interpolation between bbox1 and bbox2, i.e., it returns (1-t) * bbox1 + t * bbox2...">mi::math::lerp</a>(c1, c2, vfrac));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float4_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[2],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        store_result4(result, 0.0f);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    Texture <span class="keyword">const</span> &amp;tex = <span class="keyword">self</span>-&gt;textures[texture_idx - 1];</div>
<div class="line">    tex_lookup2D(result, tex, coord, wrap_u, wrap_v, crop_u, crop_v, frame);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_deriv_float4_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> tct_deriv_float2 *coord,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        store_result4(result, 0.0f);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> uv[2] = { coord-&gt;val.x, coord-&gt;val.y };</div>
<div class="line">    Texture <span class="keyword">const</span> &amp;tex = <span class="keyword">self</span>-&gt;textures[texture_idx - 1];</div>
<div class="line">    tex_lookup2D(result, tex, uv, wrap_u, wrap_v, crop_u, crop_v, frame);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float3_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[2],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        store_result3(result, 0.0f);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> c[4];</div>
<div class="line">    tex_lookup_float4_2d(c, <span class="keyword">self</span>, texture_idx, coord, wrap_u, wrap_v, crop_u, crop_v, frame);</div>
<div class="line"></div>
<div class="line">    result[0] = c[0];</div>
<div class="line">    result[1] = c[1];</div>
<div class="line">    result[2] = c[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_deriv_float3_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> tct_deriv_float2 *coord,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        store_result3(result, 0.0f);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> c[4];</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> uv[2] = { coord-&gt;val.x, coord-&gt;val.y };</div>
<div class="line">    tex_lookup_float4_2d(c, <span class="keyword">self</span>, texture_idx, uv, wrap_u, wrap_v, crop_u, crop_v, frame);</div>
<div class="line"></div>
<div class="line">    result[0] = c[0];</div>
<div class="line">    result[1] = c[1];</div>
<div class="line">    result[2] = c[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_texel_float4_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> coord[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> uv_tile[2],</div>
<div class="line">    <span class="keywordtype">float</span> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        store_result3(result, 0.0f);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    Texture <span class="keyword">const</span> &amp;tex = <span class="keyword">self</span>-&gt;textures[texture_idx - 1];</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> idx = (tex.size.x * coord[1] + coord[0]) * tex.ncomp;</div>
<div class="line"></div>
<div class="line">    store_result4(result,</div>
<div class="line">        <a class="code" href="classmi_1_1math_1_1Vector.html" title="Fixed-size math vector class template with generic operations. ">mi::Float32_4</a>(tex.data[idx + 0], tex.data[idx + 1], tex.data[idx + 2], tex.data[idx + 3]));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float4_3d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[3],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_w,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_w[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">    result[3] = 1.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float3_3d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[3],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_u,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_v,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga852d194e585ada01cc272e85e367ca9b" title="The texture wrap modes as defined by tex::wrap_mode in the MDL specification. ">mi::neuraylib::Tex_wrap_mode</a> wrap_w,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_u[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_v[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> crop_w[2],</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> frame)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_texel_float4_3d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> coord[3],</div>
<div class="line">    <span class="keywordtype">float</span> frame)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">    result[3] = 1.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float4_cube(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[3])</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">    result[3] = 1.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_lookup_float3_cube(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> coord[3])</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_resolution_2d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> uv_tile[2],</div>
<div class="line">    <span class="keywordtype">float</span> frame)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (texture_idx == 0 || texture_idx - 1 &gt;= self-&gt;num_textures) {</div>
<div class="line">        <span class="comment">// invalid texture returns zero</span></div>
<div class="line">        result[0] = 0;</div>
<div class="line">        result[1] = 0;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    Texture <span class="keyword">const</span> &amp;tex = <span class="keyword">self</span>-&gt;textures[texture_idx - 1];</div>
<div class="line"></div>
<div class="line">    result[0] = tex.size.x;</div>
<div class="line">    result[1] = tex.size.y;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_resolution_3d(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx,</div>
<div class="line">    <span class="keywordtype">float</span> frame)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0;</div>
<div class="line">    result[1] = 0;</div>
<div class="line">    result[2] = 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> tex_texture_isvalid(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx)</div>
<div class="line">{</div>
<div class="line">    Texture_handler <span class="keyword">const</span> *<span class="keyword">self</span> = <span class="keyword">static_cast&lt;</span>Texture_handler <span class="keyword">const </span>*<span class="keyword">&gt;</span>(self_base);</div>
<div class="line">    <span class="keywordflow">return</span> texture_idx != 0 &amp;&amp; texture_idx - 1 &lt; <span class="keyword">self</span>-&gt;num_textures;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> tex_frame(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__base.html" title="The texture handler structure that is passed to the texturing functions. ">mi::neuraylib::Texture_handler_base</a> *self_base,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> texture_idx)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0;</div>
<div class="line">    result[1] = 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Light Profiles (dummy functions)</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> df_light_profile_power(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                  light_profile_idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> df_light_profile_maximum(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                  light_profile_idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> df_light_profile_isvalid(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                  light_profile_idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> df_light_profile_evaluate(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> light_profile_idx,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span> theta_phi[2])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> df_light_profile_sample(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3], <span class="comment">// theta, phi, pdf</span></div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> light_profile_idx,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span> xi[3])</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> df_light_profile_pdf(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> light_profile_idx,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span> theta_phi[2])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// BSDF measurements (dummy functions)</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> df_bsdf_measurement_isvalid(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a>                  bsdf_measurement_index)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> df_bsdf_measurement_resolution(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> bsdf_measurement_index,</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga3b12efb3645f76a6f1233d671546bae5" title="MBSDFs can consist of two parts, which can be selected using this enumeration. ">mi::neuraylib::Mbsdf_part</a> part)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0;</div>
<div class="line">    result[1] = 0;</div>
<div class="line">    result[2] = 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> df_bsdf_measurement_evaluate(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base  *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> bsdf_measurement_index,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi_in[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi_out[2],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga3b12efb3645f76a6f1233d671546bae5" title="MBSDFs can consist of two parts, which can be selected using this enumeration. ">mi::neuraylib::Mbsdf_part</a> part)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> df_bsdf_measurement_sample(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[3],</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> bsdf_measurement_index,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi_out[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> xi[3],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga3b12efb3645f76a6f1233d671546bae5" title="MBSDFs can consist of two parts, which can be selected using this enumeration. ">mi::neuraylib::Mbsdf_part</a> part)</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> df_bsdf_measurement_pdf(</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> bsdf_measurement_index,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi_in[2],</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi_out[2],</div>
<div class="line">    <a class="code" href="group__mi__neuray__mdl__compiler.html#ga3b12efb3645f76a6f1233d671546bae5" title="MBSDFs can consist of two parts, which can be selected using this enumeration. ">mi::neuraylib::Mbsdf_part</a> part)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> df_bsdf_measurement_albedos(</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> result[4],</div>
<div class="line">    <span class="keyword">const</span> Texture_handler_base *<span class="keyword">self</span>,</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#ga607bb87332bf166dbd67cb30ca30da3a" title="32-bit unsigned integer. ">mi::Uint32</a> bsdf_measurement_index,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> theta_phi[2])</div>
<div class="line">{</div>
<div class="line">    result[0] = 0.0f;</div>
<div class="line">    result[1] = 0.0f;</div>
<div class="line">    result[2] = 0.0f;</div>
<div class="line">    result[3] = 0.0f;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Normal adaption (dummy functions)</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Can be enabled via backend option &quot;use_renderer_adapt_normal&quot;.</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef TEX_SUPPORT_NO_DUMMY_ADAPTNORMAL</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">// Implementation of adapt_normal().</span></div>
<div class="line"><span class="keywordtype">void</span> adapt_normal(</div>
<div class="line">    <span class="keywordtype">float</span>                                  result[3],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            normal[3])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return original normal</span></div>
<div class="line">    result[0] = normal[0];</div>
<div class="line">    result[1] = normal[1];</div>
<div class="line">    result[2] = normal[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif  // TEX_SUPPORT_NO_DUMMY_ADAPTNORMAL</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Scene data (dummy functions)</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef TEX_SUPPORT_NO_DUMMY_SCENEDATA</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keywordtype">bool</span> scene_data_isvalid(</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_float4(</div>
<div class="line">    <span class="keywordtype">float</span>                                  result[4],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            default_value[4],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">    result[2] = default_value[2];</div>
<div class="line">    result[3] = default_value[3];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_float3(</div>
<div class="line">    <span class="keywordtype">float</span>                                  result[3],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            default_value[3],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">    result[2] = default_value[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_color(</div>
<div class="line">    <span class="keywordtype">float</span>                                  result[3],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            default_value[3],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">    result[2] = default_value[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_float2(</div>
<div class="line">    <span class="keywordtype">float</span>                                  result[2],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            default_value[2],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">float</span> scene_data_lookup_float(</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">float</span> <span class="keyword">const</span>                            default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    <span class="keywordflow">return</span> default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_int4(</div>
<div class="line">    <span class="keywordtype">int</span>                                    result[4],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span>                              default_value[4],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">    result[2] = default_value[2];</div>
<div class="line">    result[3] = default_value[3];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_int3(</div>
<div class="line">    <span class="keywordtype">int</span>                                    result[3],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span>                              default_value[3],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">    result[2] = default_value[2];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_int2(</div>
<div class="line">    <span class="keywordtype">int</span>                                    result[2],</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keyword">const</span>                              default_value[2],</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    result[0] = default_value[0];</div>
<div class="line">    result[1] = default_value[1];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> scene_data_lookup_int(</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material                *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    <span class="keywordtype">int</span>                                    default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    <span class="keywordflow">return</span> default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_deriv_float4(</div>
<div class="line">    tct_deriv_arr_float_4                 *result,</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material_with_derivs    *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    tct_deriv_arr_float_4 <span class="keyword">const</span>           *default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    *result = *default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_deriv_float3(</div>
<div class="line">    tct_deriv_arr_float_3                 *result,</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material_with_derivs    *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    tct_deriv_arr_float_3 <span class="keyword">const</span>           *default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    *result = *default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_deriv_color(</div>
<div class="line">    tct_deriv_arr_float_3                 *result,</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material_with_derivs    *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    tct_deriv_arr_float_3 <span class="keyword">const</span>           *default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    *result = *default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_deriv_float2(</div>
<div class="line">    tct_deriv_arr_float_2                 *result,</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material_with_derivs    *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    tct_deriv_arr_float_2 <span class="keyword">const</span>           *default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    *result = *default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> scene_data_lookup_deriv_float(</div>
<div class="line">    tct_deriv_float                       *result,</div>
<div class="line">    Texture_handler_base <span class="keyword">const</span>            *self_base,</div>
<div class="line">    Shading_state_material_with_derivs    *state,</div>
<div class="line">    <span class="keywordtype">unsigned</span>                               scene_data_id,</div>
<div class="line">    tct_deriv_float <span class="keyword">const</span>                 *default_value,</div>
<div class="line">    <span class="keywordtype">bool</span>                                   uniform_lookup)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just return default value</span></div>
<div class="line">    *result = *default_value;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif  // TEX_SUPPORT_NO_DUMMY_SCENEDATA</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">// Vtables</span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// The vtable containing all texture access handlers required by the generated code</span></div>
<div class="line"><span class="comment">// in &quot;vtable&quot; mode.</span></div>
<div class="line"><a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__vtable__impl.html" title="The runtime for bitmap texture access for the generated target code can optionally be implemented in ...">mi::neuraylib::Texture_handler_vtable</a> tex_vtable = {</div>
<div class="line">    tex_lookup_float4_2d,</div>
<div class="line">    tex_lookup_float3_2d,</div>
<div class="line">    tex_texel_float4_2d,</div>
<div class="line">    tex_lookup_float4_3d,</div>
<div class="line">    tex_lookup_float3_3d,</div>
<div class="line">    tex_texel_float4_3d,</div>
<div class="line">    tex_lookup_float4_cube,</div>
<div class="line">    tex_lookup_float3_cube,</div>
<div class="line">    tex_resolution_2d,</div>
<div class="line">    tex_resolution_3d,</div>
<div class="line">    tex_texture_isvalid,</div>
<div class="line">    tex_frame,</div>
<div class="line">    df_light_profile_power,</div>
<div class="line">    df_light_profile_maximum,</div>
<div class="line">    df_light_profile_isvalid,</div>
<div class="line">    df_light_profile_evaluate,</div>
<div class="line">    df_light_profile_sample,</div>
<div class="line">    df_light_profile_pdf,</div>
<div class="line">    df_bsdf_measurement_isvalid,</div>
<div class="line">    df_bsdf_measurement_resolution,</div>
<div class="line">    df_bsdf_measurement_evaluate,</div>
<div class="line">    df_bsdf_measurement_sample,</div>
<div class="line">    df_bsdf_measurement_pdf,</div>
<div class="line">    df_bsdf_measurement_albedos,</div>
<div class="line">    adapt_normal,</div>
<div class="line">    scene_data_isvalid,</div>
<div class="line">    scene_data_lookup_float,</div>
<div class="line">    scene_data_lookup_float2,</div>
<div class="line">    scene_data_lookup_float3,</div>
<div class="line">    scene_data_lookup_float4,</div>
<div class="line">    scene_data_lookup_int,</div>
<div class="line">    scene_data_lookup_int2,</div>
<div class="line">    scene_data_lookup_int3,</div>
<div class="line">    scene_data_lookup_int4,</div>
<div class="line">    scene_data_lookup_color,</div>
<div class="line">    <span class="comment">/*m_scene_data_lookup_deriv_float*/</span>  <span class="keyword">nullptr</span>,</div>
<div class="line">    <span class="comment">/*m_scene_data_lookup_deriv_float2*/</span> <span class="keyword">nullptr</span>,</div>
<div class="line">    <span class="comment">/*m_scene_data_lookup_deriv_float3*/</span> <span class="keyword">nullptr</span>,</div>
<div class="line">    <span class="comment">/*m_scene_data_lookup_deriv_float4*/</span> <span class="keyword">nullptr</span>,</div>
<div class="line">    <span class="comment">/*m_scene_data_lookup_deriv_color*/</span>  <span class="keyword">nullptr</span></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// The vtable containing all texture access handlers required by the generated code</span></div>
<div class="line"><span class="comment">// in &quot;vtable&quot; mode with derivatives.</span></div>
<div class="line"><a class="code" href="structmi_1_1neuraylib_1_1Texture__handler__vtable__impl.html" title="The runtime for bitmap texture access for the generated target code can optionally be implemented in ...">mi::neuraylib::Texture_handler_deriv_vtable</a> tex_deriv_vtable = {</div>
<div class="line">    tex_lookup_deriv_float4_2d,</div>
<div class="line">    tex_lookup_deriv_float3_2d,</div>
<div class="line">    tex_texel_float4_2d,</div>
<div class="line">    tex_lookup_float4_3d,</div>
<div class="line">    tex_lookup_float3_3d,</div>
<div class="line">    tex_texel_float4_3d,</div>
<div class="line">    tex_lookup_float4_cube,</div>
<div class="line">    tex_lookup_float3_cube,</div>
<div class="line">    tex_resolution_2d,</div>
<div class="line">    tex_resolution_3d,</div>
<div class="line">    tex_texture_isvalid,</div>
<div class="line">    tex_frame,</div>
<div class="line">    df_light_profile_power,</div>
<div class="line">    df_light_profile_maximum,</div>
<div class="line">    df_light_profile_isvalid,</div>
<div class="line">    df_light_profile_evaluate,</div>
<div class="line">    df_light_profile_sample,</div>
<div class="line">    df_light_profile_pdf,</div>
<div class="line">    df_bsdf_measurement_isvalid,</div>
<div class="line">    df_bsdf_measurement_resolution,</div>
<div class="line">    df_bsdf_measurement_evaluate,</div>
<div class="line">    df_bsdf_measurement_sample,</div>
<div class="line">    df_bsdf_measurement_pdf,</div>
<div class="line">    df_bsdf_measurement_albedos,</div>
<div class="line">    adapt_normal,</div>
<div class="line">    scene_data_isvalid,</div>
<div class="line">    scene_data_lookup_float,</div>
<div class="line">    scene_data_lookup_float2,</div>
<div class="line">    scene_data_lookup_float3,</div>
<div class="line">    scene_data_lookup_float4,</div>
<div class="line">    scene_data_lookup_int,</div>
<div class="line">    scene_data_lookup_int2,</div>
<div class="line">    scene_data_lookup_int3,</div>
<div class="line">    scene_data_lookup_int4,</div>
<div class="line">    scene_data_lookup_color,</div>
<div class="line">    scene_data_lookup_deriv_float,</div>
<div class="line">    scene_data_lookup_deriv_float2,</div>
<div class="line">    scene_data_lookup_deriv_float3,</div>
<div class="line">    scene_data_lookup_deriv_float4,</div>
<div class="line">    scene_data_lookup_deriv_color,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><div align="right"> [<a class="el" href="mi_neuray_example_code_gen.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_execution_ptx.html">Next</a>] </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path">
<span class="footeritem">5&#160;April&#160;2022,&#160;20:40, rev.358266</span>
<span class="footeritem"><a href="https://www.nvidia.com/en-us/about-nvidia/legal-info/" target="_blank" shape="rect">&copy; 2022 NVIDIA&nbsp;Corporation.</a> All rights reserved.</span>
</div>
</body>
</html>
