<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Example for Starting and Shutting Down the MDL SDK API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="images/arcicon.ico" rel="shortcut icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_custom_stylesheet_1_8_4.css" rel="stylesheet" type="text/css"/>
<link rel='stylesheet' href='webfonts/librebaskerville/stylesheet.css' type='text/css'/>
<link rel='stylesheet' href='webfonts/sourcesanspro/stylesheet.css' type='text/css'/>
<!--ARC-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="blackheader">
<span id="blackheader_title">MDL SDK API</span>
<span>
<img src="images/nvidia_logo_transpbg.gif" alt="nvidia_logo_transpbg.gif" style=" height:1.25em; width:6.806em;"/></span>
<span id="blackheader_uplink">
<a href='../index.html' class='top_page_nav'>Up</a>
</span>
</div>
<!--
<div id="titlearea">
   <span id="projectname">
     <a id="titlelink" href="../../index.html">
       MDL SDK API
     </a>
   </span>
     <a id="projectlogo" href="http://www.nvidia-arc.com">
       <img alt="NVIDIA logo" src="images/nvidia_logo.png" style="height:2em;">
       </a>
     <a href='../index.html' class='top_page_nav'>Up</a>
</div>
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mi_neuray_example_start_shutdown.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example for Starting and Shutting Down the MDL SDK API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="right"> [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_modules.html">Next</a>] </div><p>This example accesses the main MDL SDK interface, queries the version interface, prints some version information and then starts and shuts down the MDL SDK API. See the <a class="el" href="mi_neuray_getting_started.html">Getting Started</a> Section for a description of how the example programs can be compiled.</p>
<h1><a class="anchor" id="example_start_shutdown_new"></a>
New Topics</h1>
<ul>
<li>Naming conventions.</li>
<li>Main include files.</li>
<li>Main API access point.</li>
<li>Interfaces and handles.</li>
<li>Starting and shutting down the MDL SDK API.</li>
</ul>
<h1><a class="anchor" id="example_start_shutdown_descr"></a>
Detailed Description</h1>
<dl>
<dt><b> Naming conventions </b> </dt>
<dd><p class="startdd"><br/>
 The MDL SDK is written in C++. It uses the <a class="el" href="namespacemi.html" title="Common namespace for APIs of NVIDIA Advanced Rendering Center GmbH. ">mi</a> and <a class="el" href="namespacemi_1_1neuraylib.html" title="Namespace for the MDL SDK API. ">mi::neuraylib</a> namespaces for its own identifiers, or the MI_NEURAYLIB_ prefix for macros.</p>
<p>Multiple words are concatenated with <code>_</code> to form identifiers. Function names are all lower case, while types and classes start with one initial upper-case letter.</p>
<p class="enddd"></p>
</dd>
<dt><b> Main include files </b> </dt>
<dd><p class="startdd"><br/>
 The include file <a class="el" href="mdl__sdk_8h.html" title="MDL SDK API. ">mi/mdl_sdk.h</a> provides all the functionality of the MDL SDK API.</p>
<p class="enddd"></p>
</dd>
<dt><b> Main API access point </b> </dt>
<dd><p class="startdd"><br/>
 The <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a> function is the only public access point to all algorithms and data structures in the API (see <a class="el" href="mi_neuray_design.html">Library Design</a> for an explanation why). To obtain a pointer to the main interface <a class="el" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a>, call this function with the <a class="el" href="classmi_1_1base_1_1Interface__declare.html#a7ab89c594dc3cbbbb9aeffaf33b72a52" title="Declares the interface ID (IID) of this interface. ">mi::neuraylib::INeuray::IID()</a> as its <code>iid</code> parameter. If no compatible interface can be found in the library, a <code>NULL</code> pointer is returned. In this case, you can use <a class="el" href="classmi_1_1base_1_1Interface__declare.html#a7ab89c594dc3cbbbb9aeffaf33b72a52" title="Declares the interface ID (IID) of this interface. ">mi::neuraylib::IVersion::IID()</a> to request a <a class="el" href="classmi_1_1neuraylib_1_1IVersion.html" title="Abstract interface for accessing version information. ">mi::neuraylib::IVersion</a> interface from the <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a> for diagnostics. The <a class="el" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a> interface can only be accessed once per process.</p>
<p>Before you are able to call the <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a> function, you need to load the MDL SDK DSO and to locate the factory function. The convenience function <code>load_and_get_ineuray()</code> abstracts these platform-dependent steps.</p>
<p>Note that it is not required to use <code>load_and_get_ineuray()</code>. In particular in larger setups you might want to write your own code to load the MDL SDK DSO and to locate the factory function. In such cases, you call <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a> directly. For simplicity, the examples will use the convenience function <code>load_and_get_ineuray()</code> instead of <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a>.</p>
<p class="enddd"></p>
</dd>
<dt><b> Interfaces and handles </b> </dt>
<dd><p class="startdd"><br/>
 Except for trivial classes, such as the math vector class, all classes in the MDL SDK API are implemented using <em>interfaces</em>. See <a class="el" href="mi_neuray_design.html">Library Design</a> for an explanation. Interfaces are created and destroyed by the MDL SDK API. They implement reference counting for life-time control and cheap copying operations. Interface names start with an <code>I</code> prefix.</p>
<p>Whenever you do not need an interface any longer, you have to release it by calling its <code>release()</code> method. Omitting such calls leads to memory leaks. To simplify your life we provide a simple handle class <a class="el" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle</a>. This handle class maintains a pointer semantic while supporting reference counting for interface pointers. For example, the <code>-&gt;</code> operator acts on the underlying interface pointer, which means that you can use a handle to a particular interface pointer in a way very similar to the interface pointer itself. The destructor calls <code>release()</code> on the interface pointer, copy constructor and assignment operator take care of retaining and releasing the interface pointer as necessary.</p>
<p>Note that the handle class has two different constructors to deal with ownership of the interface pointer. See the <a class="el" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle</a> documentation for details.</p>
<p>Note that it is also possible to use other handle class implementations, e.g., <code>std::tr1::shared_ptr&lt;T&gt;</code> (or <code>boost::shared_ptr&lt;T&gt;</code>). In case you prefer to use such handle classes, you have to ensure that their destructor calls the <code>release()</code> method of the interface pointer. This can be achieved by passing an appropriate argument as second parameter, e.g., </p>
<div class="fragment"><div class="line">std::tr1::shared_ptr&lt;T&gt; p ( load_and_get_ineuray(), std::mem_fun (&amp;T::release));</div>
</div><!-- fragment --><p class="enddd"></p>
</dd>
<dt><b> Starting and shutting down the MDL SDK API </b> </dt>
<dd><p class="startdd"><br/>
 The <a class="el" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a> interface is used to start and shut down the MDL SDK API. The API can only be used after it has been started (and before it has been shut down). Startup does not happen during the <a class="el" href="group__mi__neuray__ineuray.html#gaf81abce7a57cc4bebe22bd5547ea1916" title="Unique public access point to the MDL SDK API. ">mi_factory()</a> call because you might want to configure the behavior of the API, which has to happen before startup.</p>
<p>The status of the API can be queried using the <a class="el" href="classmi_1_1neuraylib_1_1INeuray.html#aba15246ad1cdd7ef8aa9355bc7380aa2" title="Returns the status of the library. ">mi::neuraylib::INeuray::get_status()</a> method.</p>
<p>Finally, you have to shut down the MDL SDK API. At this point, you should have released all interface pointers except the pointer to the main <a class="el" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a> interface. If you are using the handle class, make sure that all handles have gone out of scope.</p>
<p class="enddd"></p>
</dd>
</dl>
<h1><a class="anchor" id="example_start_shutdown"></a>
Example Source</h1>
<p><b>Source Code Location:</b> <code>examples/mdl_sdk/shared/example_shared.h</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// examples/mdl_sdk/shared/example_shared.h</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Code shared by all examples</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef EXAMPLE_SHARED_H</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define EXAMPLE_SHARED_H</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;utils/io.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;utils/mdl.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;utils/os.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;utils/strings.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">void</span> exit_failure_(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line,</div>
<div class="line">    std::string message)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// print message</span></div>
<div class="line">    <span class="keywordflow">if</span> (message.empty())</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Fatal error in file: %s line: %d\n\nClosing the example.\n&quot;</span>, file, line);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Fatal error in file: %s line: %d\n  %s\n\nClosing the example.\n&quot;</span>, </div>
<div class="line">            file, line, message.c_str());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// keep console open</span></div>
<div class="line"><span class="preprocessor">    #ifdef MI_PLATFORM_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (IsDebuggerPresent()) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Press enter to continue . . . \n&quot;</span>);</div>
<div class="line">            fgetc(stdin);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">    <span class="comment">// kill the application</span></div>
<div class="line">    exit(EXIT_FAILURE);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">void</span> exit_failure_(<span class="keyword">const</span> <span class="keywordtype">char</span>* file, <span class="keywordtype">int</span> line)</div>
<div class="line">{</div>
<div class="line">    exit_failure_(file, line, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#define exit_failure(...) \</span></div>
<div class="line"><span class="preprocessor">    exit_failure_(__FILE__, __LINE__, mi::examples::strings::format(__VA_ARGS__))</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">void</span> exit_success_()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// keep console open</span></div>
<div class="line"><span class="preprocessor">    #ifdef MI_PLATFORM_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span>        <span class="keywordflow">if</span> (IsDebuggerPresent()) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;\nPress enter to continue . . . \n&quot;</span>);</div>
<div class="line">            fgetc(stdin);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor"></span>    exit(EXIT_SUCCESS);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define exit_success() exit_success_(); return EXIT_SUCCESS; // no warning about missing return</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Helper macro. Checks whether the expression is true and if not prints a message and exits.</span></div>
<div class="line"><span class="preprocessor">#define check_success( expr) \</span></div>
<div class="line"><span class="preprocessor">    do { \</span></div>
<div class="line"><span class="preprocessor">        if( !(expr)) \</span></div>
<div class="line"><span class="preprocessor">            exit_failure( &quot;%s&quot;, #expr); \</span></div>
<div class="line"><span class="preprocessor">    } while( false)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">void</span> print_message(</div>
<div class="line">    <a class="code" href="group__mi__base__ilogger.html#ga35cadb98d3212ad7941f401da374f28d" title="Constants for possible message severities. ">mi::base::details::Message_severity</a> severity,</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IMessage.html#acd9444148b559e3d89a2b0042db48207" title="The possible kinds of messages. ">mi::neuraylib::IMessage::Kind</a> kind,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* msg)</div>
<div class="line">{</div>
<div class="line">    std::string s_kind = mi::examples::strings::to_string(kind);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (mi::examples::mdl::g_logger) {</div>
<div class="line">        mi::examples::mdl::g_logger-&gt;message(severity, s_kind.c_str(), msg);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        std::string s_severity = mi::examples::strings::to_string(severity);</div>
<div class="line"></div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;%s: %s %s\n&quot;</span>, s_severity.c_str(), s_kind.c_str(), msg);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">bool</span> print_messages(<a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html" title="The execution context can be used to query status information like error and warning messages concern...">mi::neuraylib::IMdl_execution_context</a>* context)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> i = 0, n = context-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html#ac3caefb040df7e0d90232c56af259cfb" title="Returns the number of messages. ">get_messages_count</a>(); i &lt; n; ++i) {</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IMessage&gt;</a> message(context-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html#a383fdfde26de9864632a48c7ae727f7e" title="Returns the message at index or NULL, if no such index exists. ">get_message</a>(i));</div>
<div class="line">        print_message(message-&gt;get_severity(), message-&gt;get_kind(), message-&gt;get_string());</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> context-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__execution__context.html#a65f343d795e12da9a1ba79cbe4b3b123" title="Returns the number of error messages. ">get_error_messages_count</a>() == 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// ------------------------------------------------------------------------------------------------</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// wrap the example entry point in order to support UTF8 arguments</span></div>
<div class="line"><span class="preprocessor">#ifdef MI_PLATFORM_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #define MAIN_UTF8 main_utf8</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #define COMMANDLINE_TO_UTF8 \</span></div>
<div class="line"><span class="preprocessor">        int wmain(int argc, wchar_t* argv[]) { \</span></div>
<div class="line"><span class="preprocessor">            char** argv_utf8 = new char*[argc]; \</span></div>
<div class="line"><span class="preprocessor">            for (int i = 0; i &lt; argc; i++) { \</span></div>
<div class="line"><span class="preprocessor">                LPWSTR warg = argv[i]; \</span></div>
<div class="line"><span class="preprocessor">                DWORD size = WideCharToMultiByte(CP_UTF8, 0, warg, -1, NULL, 0, NULL, NULL); \</span></div>
<div class="line"><span class="preprocessor">                check_success(size &gt; 0); \</span></div>
<div class="line"><span class="preprocessor">                argv_utf8[i] = new char[size]; \</span></div>
<div class="line"><span class="preprocessor">                DWORD result = WideCharToMultiByte(CP_UTF8, 0, warg, -1, argv_utf8[i], size, NULL, NULL); \</span></div>
<div class="line"><span class="preprocessor">                check_success(result &gt; 0); \</span></div>
<div class="line"><span class="preprocessor">            } \</span></div>
<div class="line"><span class="preprocessor">            SetConsoleOutputCP(CP_UTF8); \</span></div>
<div class="line"><span class="preprocessor">            int result = main_utf8(argc, argv_utf8); \</span></div>
<div class="line"><span class="preprocessor">            delete[] argv_utf8; \</span></div>
<div class="line"><span class="preprocessor">            return result; \</span></div>
<div class="line"><span class="preprocessor">        }</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#else // MI_PLATFORM_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">    #define MAIN_UTF8 main</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">    #define COMMANDLINE_TO_UTF8</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#endif // MI_PLATFORM_WINDOWS</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#endif // MI_EXAMPLE_SHARED_H</span></div>
</div><!-- fragment --><p><b>Source Code Location:</b> <code>examples/mdl_sdk/start_shutdown/example_start_shutdown.cpp</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// examples/mdl_sdk/start_shutdown/example_start_shutdown.cpp</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Obtain an INeuray interface, start the MDL SDK and shut it down.</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Include code shared by all examples.</span></div>
<div class="line"><span class="preprocessor">#include &quot;example_shared.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// The main function initializes the MDL SDK, starts it, and shuts it down after waiting for</span></div>
<div class="line"><span class="comment">// user input.</span></div>
<div class="line"><span class="keywordtype">int</span> MAIN_UTF8( <span class="keywordtype">int</span> <span class="comment">/*argc*/</span>, <span class="keywordtype">char</span>* <span class="comment">/*argv*/</span>[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Get the INeuray interface in a suitable smart pointer.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::INeuray&gt;</a> neuray( mi::examples::mdl::load_and_get_ineuray());</div>
<div class="line">    <span class="keywordflow">if</span> ( !neuray.is_valid_interface())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Error: The MDL SDK library failed to load and to provide &quot;</span></div>
<div class="line">                     <span class="stringliteral">&quot;the mi::neuraylib::INeuray interface.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Print library version information.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IVersion&gt;</a> version(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<span class="keyword">const</span> <a class="code" href="classmi_1_1neuraylib_1_1IVersion.html" title="Abstract interface for accessing version information. ">mi::neuraylib::IVersion</a>&gt;());</div>
<div class="line"></div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK header version          = %s\n&quot;</span>,</div>
<div class="line">        <a class="code" href="group__mi__neuray__version.html#ga6fd631aa0754f5acffe72703c13a9672" title="The MDL SDK product version number in a string representation, such as &quot;2.0&quot;. ">MI_NEURAYLIB_PRODUCT_VERSION_STRING</a>);</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library product name    = %s\n&quot;</span>, version-&gt;get_product_name());</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library product version = %s\n&quot;</span>, version-&gt;get_product_version());</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library build number    = %s\n&quot;</span>, version-&gt;get_build_number());</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library build date      = %s\n&quot;</span>, version-&gt;get_build_date());</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library build platform  = %s\n&quot;</span>, version-&gt;get_build_platform());</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library version string  = \&quot;%s\&quot;\n&quot;</span>, version-&gt;get_string());</div>
<div class="line"></div>
<div class="line">    <a class="code" href="structmi_1_1base_1_1Uuid.html" title="A 128 bit representation of a universally unique identifier (UUID or GUID). ">mi::base::Uuid</a> neuray_id_libraray = version-&gt;get_neuray_iid();</div>
<div class="line">    <a class="code" href="structmi_1_1base_1_1Uuid.html" title="A 128 bit representation of a universally unique identifier (UUID or GUID). ">mi::base::Uuid</a> neuray_id_interface = <a class="code" href="classmi_1_1base_1_1Interface__declare.html#a7ab89c594dc3cbbbb9aeffaf33b72a52" title="Declares the interface ID (IID) of this interface. ">mi::neuraylib::INeuray::IID</a>();</div>
<div class="line"></div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK header interface ID     = &lt;%2x, %2x, %2x, %2x&gt;\n&quot;</span>,</div>
<div class="line">        neuray_id_interface.<a class="code" href="structmi_1_1base_1_1Uuid.html#a3411d355a53b97f8941b314dca1bd3e7" title="First value. ">m_id1</a>,</div>
<div class="line">        neuray_id_interface.<a class="code" href="structmi_1_1base_1_1Uuid.html#a7d3f41dd856c46b1c45d57e7470546c5" title="Second value. ">m_id2</a>,</div>
<div class="line">        neuray_id_interface.<a class="code" href="structmi_1_1base_1_1Uuid.html#addc690e5f4ea722fe555f1c80d41d803" title="Third value. ">m_id3</a>,</div>
<div class="line">        neuray_id_interface.<a class="code" href="structmi_1_1base_1_1Uuid.html#af0c07bd253a05adf553d5978dacdb312" title="Fourth value. ">m_id4</a>);</div>
<div class="line">    fprintf( stderr, <span class="stringliteral">&quot;MDL SDK library interface ID    = &lt;%2x, %2x, %2x, %2x&gt;\n\n&quot;</span>,</div>
<div class="line">        neuray_id_libraray.m_id1,</div>
<div class="line">        neuray_id_libraray.m_id2,</div>
<div class="line">        neuray_id_libraray.m_id3,</div>
<div class="line">        neuray_id_libraray.m_id4);</div>
<div class="line"></div>
<div class="line">    version = 0;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// configuration settings go here, none in this example,</span></div>
<div class="line">    <span class="comment">// but for a standard initialization the other examples use this helper function:</span></div>
<div class="line">    <span class="comment">// if ( !mi::examples::mdl::configure(neuray.get()))</span></div>
<div class="line">    <span class="comment">//     exit_failure(&quot;Failed to initialize the SDK.&quot;);</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// After all configurations, the MDL SDK is started. A return code of 0 implies success. The</span></div>
<div class="line">    <span class="comment">// start can be blocking or non-blocking. Here the blocking mode is used so that you know that</span></div>
<div class="line">    <span class="comment">// the MDL SDK is up and running after the function call. You can use a non-blocking call to do</span></div>
<div class="line">    <span class="comment">// other tasks in parallel and check with</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//      neuray-&gt;get_status() == mi::neuraylib::INeuray::STARTED</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// if startup is completed.</span></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result = neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#afdd076cf54b3e1eabbd841bd1f77847b" title="Starts the operation of the MDL SDK library. ">start</a>( <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ( result != 0)</div>
<div class="line">        exit_failure( <span class="stringliteral">&quot;Failed to initialize the SDK. Result code: %d&quot;</span>, result);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// scene graph manipulations and rendering calls go here, none in this example.</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// Shutting the MDL SDK down in blocking mode. Again, a return code of 0 indicates success.</span></div>
<div class="line">    <span class="keywordflow">if</span> (neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a01d0574d048798c76f8e29f91a4f6fea" title="Shuts down the library. ">shutdown</a>( <span class="keyword">true</span>) != 0)</div>
<div class="line">        exit_failure( <span class="stringliteral">&quot;Failed to shutdown the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Unload the MDL SDK</span></div>
<div class="line">    neuray = <span class="keyword">nullptr</span>; <span class="comment">// free the handles that holds the INeuray instance</span></div>
<div class="line">    <span class="keywordflow">if</span> ( !mi::examples::mdl::unload())</div>
<div class="line">        exit_failure( <span class="stringliteral">&quot;Failed to unload the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    exit_success();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Convert command line arguments to UTF8 on Windows</span></div>
<div class="line">COMMANDLINE_TO_UTF8</div>
</div><!-- fragment --><div align="right"> [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_modules.html">Next</a>] </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path">
<span class="footeritem">5&#160;April&#160;2022,&#160;20:40, rev.358266</span>
<span class="footeritem"><a href="https://www.nvidia.com/en-us/about-nvidia/legal-info/" target="_blank" shape="rect">&copy; 2022 NVIDIA&nbsp;Corporation.</a> All rights reserved.</span>
</div>
</body>
</html>
