<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Example for Instantiation of MDL Definitions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="images/arcicon.ico" rel="shortcut icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_custom_stylesheet_1_8_4.css" rel="stylesheet" type="text/css"/>
<link rel='stylesheet' href='webfonts/librebaskerville/stylesheet.css' type='text/css'/>
<link rel='stylesheet' href='webfonts/sourcesanspro/stylesheet.css' type='text/css'/>
<!--ARC-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="blackheader">
<span id="blackheader_title">MDL SDK API</span>
<span>
<img src="images/nvidia_logo_transpbg.gif" alt="nvidia_logo_transpbg.gif" style=" height:1.25em; width:6.806em;"/></span>
<span id="blackheader_uplink">
<a href='../index.html' class='top_page_nav'>Up</a>
</span>
</div>
<!--
<div id="titlearea">
   <span id="projectname">
     <a id="titlelink" href="../../index.html">
       MDL SDK API
     </a>
   </span>
     <a id="projectlogo" href="http://www.nvidia-arc.com">
       <img alt="NVIDIA logo" src="images/nvidia_logo.png" style="height:2em;">
       </a>
     <a href='../index.html' class='top_page_nav'>Up</a>
</div>
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mi_neuray_example_instantiation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example for Instantiation of MDL Definitions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="right"> [<a class="el" href="mi_neuray_example_modules.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_calls.html">Next</a>] </div><p>This example creates material instances and function calls by instantiating the corresponding material and function definitions. It also shows how to change arguments of material instances and function calls.</p>
<h1><a class="anchor" id="example_instantiation_new"></a>
New Topics</h1>
<ul>
<li>Instantiating material and function definitions</li>
<li>Changing arguments</li>
<li>Creating material and function variants</li>
</ul>
<h1><a class="anchor" id="example_instantiation_descr"></a>
Detailed Description</h1>
<dl>
<dt><b> Instantiating material and function definitions </b> </dt>
<dd><p class="startdd"><br/>
 The method <code>instantiate_definitions()</code> shows how to instantiate a material or function definition from a previously <a class="el" href="mi_neuray_example_modules.html">loaded module</a>. The method <a class="el" href="classmi_1_1neuraylib_1_1IFunction__definition.html#a19d59ab5c1a19eb45c28c287c01d9af3" title="Creates a new function call. ">mi::neuraylib::IFunction_definition::create_function_call()</a> is used to instantiate a given material or function definition.</p>
<p>There are two important cases to distinguish: all parameters have defaults, or some parameters have no defaults. The first part of the method deals with a material definition where all parameters have defaults. Therefore, when creating the material instance, it is not necessary to provide any arguments since the defaults are used automatically. The second part of the method deals with a function definition without defaults for its parameters. It is therefore mandatory to provide the initial arguments.</p>
<p class="enddd"></p>
</dd>
<dt><b> Changing arguments </b> </dt>
<dd><p class="startdd"><br/>
 The method <code>change_arguments()</code> shows how to change an argument of a material instance or a function call. Essentially, you have to call <a class="el" href="classmi_1_1neuraylib_1_1IFunction__call.html#a129cfc6a3a406d41444eb5cd4f95b23b" title="Sets the argument at index. ">mi::neuraylib::IFunction_call::set_argument()</a> with the new argument. The method illustrates two ways for obtaining the new argument.</p>
<p>The first way is to create to obtain the old value, to clone it (because it is immutable), to modify the value, and to pass it to the material instance or function call. The second way is to use <a class="el" href="classmi_1_1neuraylib_1_1Argument__editor.html#a253acf07199960e776912d9011646fab" title="Sets a non-compound argument. ">mi::neuraylib::Argument_editor::set_value()</a> which simplifies these steps.</p>
<p class="enddd"></p>
</dd>
<dt><b> Creating material and function variants </b> </dt>
<dd><p class="startdd"><br/>
 A variant is a material or function definition that is based on a prototype definition, but has different defaults. In this example we create an MDL module <code>"::variants"</code> with a single new material definition: a variant of <code>"::example::diffuse_material"</code>, but with a green default for <code>"tint"</code>.</p>
<p>Variants are created with the help of the module builder. Use <a class="el" href="classmi_1_1neuraylib_1_1IMdl__factory.html#acfb3f3619135d5162196851186472dfb" title="Creates a module builder for a given module. ">mi::neuraylib::IMdl_factory::create_module_builder()</a> to create an instance of the module builder, passing the module name and the minimal and maximal desired MDL version of the new module.</p>
<p>Use <a class="el" href="classmi_1_1neuraylib_1_1IMdl__module__builder.html#a13c3eb3f77014dd7a08eac229ec5cbdf" title="Adds a variant to the module. ">mi::neuraylib::IMdl_module_builder::add_variant()</a> to create new variants. This requires the name of the new variant, and the name of the prototype it is based on. Optionally, you can specify other properties, like new defaults, annotations, return annotations, and the flag for the 'export' key.</p>
<p class="enddd">A dump of the instantiated definition as well as the exported module show that the new material definition really is a variant of the prototype but with different defaults.  </p>
</dd>
</dl>
<h1><a class="anchor" id="example_instantiation"></a>
Example Source</h1>
<p><b>Source Code Location:</b> <code>examples/mdl_sdk/instantiation/example_instantiation.cpp</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// examples/mdl_sdk/instantiation/example_instantiation.cpp</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Instantiates a material and a function definition and changes argument values.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;example_shared.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* material_definition_name</div>
<div class="line">    = <span class="stringliteral">&quot;mdl::nvidia::sdk_examples::tutorials::example_material(color,float)&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* material_instance_name   = <span class="stringliteral">&quot;instance of example_material&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* function_definition_name</div>
<div class="line">    = <span class="stringliteral">&quot;mdl::nvidia::sdk_examples::tutorials::example_function(color,float)&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* function_call_name       = <span class="stringliteral">&quot;call of example_function&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Utility function to dump the arguments of a material instance or function call.</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> dump_instance(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html" title="The interface for creating expressions. ">mi::neuraylib::IExpression_factory</a>* expression_factory, <span class="keyword">const</span> T* material, std::ostream&amp; s)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> count = material-&gt;get_parameter_count();</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression_list&gt;</a> arguments( material-&gt;get_arguments());</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> index = 0; index &lt; count; index++) {</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression&gt;</a> argument(</div>
<div class="line">            arguments-&gt;get_expression( index));</div>
<div class="line">        std::string name = material-&gt;get_parameter_name( index);</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IString&gt;</a> argument_text(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af61dee867b056fc0bdee1edc4707aa60" title="Returns a textual representation of an expression. ">dump</a>( argument.get(), name.c_str(), 1));</div>
<div class="line">        s &lt;&lt; <span class="stringliteral">&quot;    argument &quot;</span> &lt;&lt; argument_text-&gt;get_c_str() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">    s &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Instantiates a material definition and a function definition.</span></div>
<div class="line"><span class="keywordtype">void</span> instantiate_definitions(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a>* neuray, <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_impexp_api&gt;</a> mdl_impexp_api(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html" title="API component for MDL related import and export operations. ">mi::neuraylib::IMdl_impexp_api</a>&gt;());</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IMdl_factory&gt;</a> mdl_factory(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>&gt;());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IValue_factory&gt;</a> value_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a76919730caa41d98004f3edcff45d1df" title="Returns an MDL value factory for the given transaction. ">create_value_factory</a>( transaction));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IExpression_factory&gt;</a> expression_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#aaa79f7a5d2d2973f7d34e007f22fc949" title="Returns an MDL expression factory for the given transaction. ">create_expression_factory</a>( transaction));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_execution_context&gt;</a> context(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a78a9a6489592c90ea49e0fe0ac8be235" title="Creates an execution context. ">create_execution_context</a>());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Load the module &quot;tutorials&quot; and access it from the DB.</span></div>
<div class="line">    check_success( mdl_impexp_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html#a5e195d80915190eb40c5995ccfeaa4c9" title="Loads an MDL module from disk (or a builtin module) into the database. ">load_module</a>(</div>
<div class="line">        transaction, <span class="stringliteral">&quot;::nvidia::sdk_examples::tutorials&quot;</span>, context.get()) &gt;= 0);</div>
<div class="line">    print_messages( context.get());</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IModule&gt;</a> module(</div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IModule.html" title="This interface represents an MDL module. ">mi::neuraylib::IModule</a>&gt;( <span class="stringliteral">&quot;mdl::nvidia::sdk_examples::tutorials&quot;</span>));</div>
<div class="line">    check_success( module.is_valid_interface());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Instantiation of a material definition</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Access the material definition &quot;example_material&quot;.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> material_definition(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">                material_definition_name));</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Since all parameter of this material definition have defaults we can instantiate the</span></div>
<div class="line">        <span class="comment">// definition without the need to explicitly provide initial arguments.</span></div>
<div class="line">        <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result = 0;</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">            material_definition-&gt;create_function_call( 0, &amp;result));</div>
<div class="line">        check_success( result == 0);</div>
<div class="line"></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping material instance \&quot;&quot;</span> &lt;&lt; material_instance_name &lt;&lt; <span class="stringliteral">&quot;\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), material_instance.get(), std::cout);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// We are going to change the arguments later, so store the instance for now in the DB.</span></div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#ae1c0cccf93ff990b7af8d0d0379f7c09" title="Stores the element db_element in the database under the name name and with the privacy level privacy...">store</a>( material_instance.get(), material_instance_name);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Instantiation of a function definition</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Access the function definition &quot;example_function(color,float)&quot;.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> function_definition(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">                function_definition_name));</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Since not all parameters of this function definition have defaults we have to provide</span></div>
<div class="line">        <span class="comment">// explicitly initial arguments to create an instance of the definition.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue&gt;</a> tint_value(</div>
<div class="line">            value_factory-&gt;create_color( 1.0f, 0.0f, 0.0f));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> tint_expr(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( tint_value.get()));</div>
<div class="line">        arguments-&gt;add_expression( <span class="stringliteral">&quot;tint&quot;</span>, tint_expr.get());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue&gt;</a> distance_value(</div>
<div class="line">            value_factory-&gt;create_float( 2.0f));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> distance_expr(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( distance_value.get()));</div>
<div class="line">        arguments-&gt;add_expression( <span class="stringliteral">&quot;distance&quot;</span>, distance_expr.get());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Instantiate the function definition using &quot;arguments&quot; as initial arguments.</span></div>
<div class="line">        <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result = 0;</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> function_call(</div>
<div class="line">            function_definition-&gt;create_function_call( arguments.get(), &amp;result));</div>
<div class="line">        check_success( result == 0);</div>
<div class="line"></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping function call \&quot;&quot;</span> &lt;&lt; function_call_name &lt;&lt; <span class="stringliteral">&quot;\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), function_call.get(), std::cout);</div>
<div class="line"></div>
<div class="line">        <span class="comment">// We are going to change the arguments later, so store the call for now in the DB.</span></div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#ae1c0cccf93ff990b7af8d0d0379f7c09" title="Stores the element db_element in the database under the name name and with the privacy level privacy...">store</a>( function_call.get(), function_call_name);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Changes the arguments of a previously create material instance or function call.</span></div>
<div class="line"><span class="keywordtype">void</span> change_arguments( <a class="code" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a>* neuray, <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IMdl_factory&gt;</a> mdl_factory(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>&gt;());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IValue_factory&gt;</a> value_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a76919730caa41d98004f3edcff45d1df" title="Returns an MDL value factory for the given transaction. ">create_value_factory</a>( transaction));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IExpression_factory&gt;</a> expression_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#aaa79f7a5d2d2973f7d34e007f22fc949" title="Returns an MDL expression factory for the given transaction. ">create_expression_factory</a>( transaction));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Changing arguments: cloning the old value and modifying the clone</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Edit the instance of the material definition &quot;example_material&quot;.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#a35971d023789574ee31dd05768fc7fe1" title="Retrieves an element from the database and returns it ready for editing. ">edit</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;( material_instance_name));</div>
<div class="line">        check_success( material_instance.is_valid_interface());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Get the old argument for the &quot;tint&quot; parameter and clone it.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">            material_instance-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html#a979d0d5dd0a1d7cddc2346b68d8ac2e1" title="Returns all arguments. ">get_arguments</a>());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression&gt;</a> argument(</div>
<div class="line">            arguments-&gt;get_expression( <span class="stringliteral">&quot;tint&quot;</span>));</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Change the value of the clone and set it as new argument. Here we use prior knowledge</span></div>
<div class="line">        <span class="comment">// that the type of the parameter is a color and the expression is a constant.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> new_argument(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a050227a5e154a23fc3f09275f8bd7dde" title="Clones the given expression. ">clone</a>( argument.get()));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_constant&gt;</a> new_argument_constant(</div>
<div class="line">            new_argument-&gt;get_interface&lt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__constant.html" title="A constant expression. ">mi::neuraylib::IExpression_constant</a>&gt;());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue_color&gt;</a> new_argument_value(</div>
<div class="line">            new_argument_constant-&gt;get_value&lt;<a class="code" href="classmi_1_1neuraylib_1_1IValue__color.html" title="A value of type color. ">mi::neuraylib::IValue_color</a>&gt;());</div>
<div class="line">        <a class="code" href="group__mi__neuray__mdl__types.html#ga38e3698aa9a958288240983deb618772" title="Simplifies setting the value of mi::neuraylib::IValue from the corresponding classes from the base an...">set_value</a>( new_argument_value.get(), <a class="code" href="group__mi__neuray__compounds.html#gafd51fb3363c0ed0ee017797c9af110bd" title="RGBA color class. ">mi::math::Color</a>( 0.0f, 1.0f, 0.0f));</div>
<div class="line">        check_success( material_instance-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html#a129cfc6a3a406d41444eb5cd4f95b23b" title="Sets the argument at index. ">set_argument</a>( <span class="stringliteral">&quot;tint&quot;</span>, new_argument.get()) == 0);</div>
<div class="line"></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping modified material instance \&quot;&quot;</span> &lt;&lt; material_instance_name &lt;&lt; <span class="stringliteral">&quot;\&quot;:&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), material_instance.get(), std::cout);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Changing arguments: using the argument editor</span></div>
<div class="line">    {</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Edit the instance of the function definition &quot;volume_coefficient()&quot;. Here we use</span></div>
<div class="line">            <span class="comment">// prior knowledge that the type of the parameter is a color.</span></div>
<div class="line">            <a class="code" href="classmi_1_1neuraylib_1_1Argument__editor.html" title="A wrapper around the interface for MDL material instances and function calls. ">mi::neuraylib::Argument_editor</a> argument_editor(</div>
<div class="line">                transaction, function_call_name, mdl_factory.get());</div>
<div class="line">            <a class="code" href="classmi_1_1math_1_1Color.html" title="Standard RGBA color class with floating point elements and operations. ">mi::math::Color</a> blue( 0.0f, 0.0f, 1.0f);</div>
<div class="line">            check_success( argument_editor.set_value( <span class="stringliteral">&quot;tint&quot;</span>, blue) == 0);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> function_call(</div>
<div class="line">            transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#a35971d023789574ee31dd05768fc7fe1" title="Retrieves an element from the database and returns it ready for editing. ">edit</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;( function_call_name));</div>
<div class="line">        check_success( function_call.is_valid_interface());</div>
<div class="line"></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping modified function call \&quot;&quot;</span> &lt;&lt; function_call_name &lt;&lt; <span class="stringliteral">&quot;\&quot;:&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), function_call.get(), std::cout);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Iterates over an annotation block and prints annotations and their parameters.</span></div>
<div class="line"><span class="keywordtype">void</span> print_annotations(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1neuraylib_1_1IType__factory.html" title="The interface for creating types. ">mi::neuraylib::IType_factory</a>* type_factory,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classmi_1_1neuraylib_1_1IAnnotation__block.html" title="An annotation block is an array of annotations. ">mi::neuraylib::IAnnotation_block</a>* anno_block)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1Annotation__wrapper.html" title="A wrapper around the interfaces for MDL annotations. ">mi::neuraylib::Annotation_wrapper</a> annotations( anno_block);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> </div>
<div class="line">        &lt;&lt; annotations.get_annotation_count() &lt;&lt; <span class="stringliteral">&quot; annotation(s).\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> a = 0; a &lt; annotations.get_annotation_count(); ++a)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IAnnotation&gt;</a> anno(anno_block-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IAnnotation__block.html#a8c73f5174a712acc0164c600d38cb9b6" title="Returns the annotation for index, or NULL if index is out of bounds. ">get_annotation</a>(a));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IAnnotation_definition&gt;</a> anno_def(anno-&gt;get_definition());</div>
<div class="line">        std::string name = anno_def-&gt;get_mdl_simple_name();</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;    \&quot;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;\&quot; with &quot;</span></div>
<div class="line">            &lt;&lt; annotations.get_annotation_param_count( a) &lt;&lt; <span class="stringliteral">&quot; parameter(s):\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>( <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> p = 0; p &lt; annotations.get_annotation_param_count( a); ++p)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IType&gt;</a> type_handle(</div>
<div class="line">                annotations.get_annotation_param_type( a, p));</div>
<div class="line">            <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IString&gt;</a> type_text( type_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IType__factory.html#a1ceda6fc71512bf47916e0ac3cc2ab67" title="Returns a textual representation of a type. ">dump</a>( type_handle.get()));</div>
<div class="line"></div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;        \&quot;&quot;</span> &lt;&lt; annotations.get_annotation_param_name( a, p)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;\&quot; of type \&quot;&quot;</span></div>
<div class="line">                &lt;&lt; type_text-&gt;get_c_str() &lt;&lt; <span class="stringliteral">&quot;\&quot; = &quot;</span>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">switch</span>( type_handle-&gt;get_kind())</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="classmi_1_1neuraylib_1_1IType.html#a1bb7485ef5c5685572dcff9a674b9dd9a73a2dceadfd1dbc4fb59eaefcd213c5f" title="The string type. See mi::neuraylib::IType_string. ">mi::neuraylib::IType::TK_STRING</a>:</div>
<div class="line">                {</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">char</span>* string_value = <span class="keyword">nullptr</span>;</div>
<div class="line">                    annotations.get_annotation_param_value&lt;<span class="keyword">const</span> <span class="keywordtype">char</span>*&gt;( a, p, string_value);</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; string_value &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">case</span> <a class="code" href="classmi_1_1neuraylib_1_1IType.html#a1bb7485ef5c5685572dcff9a674b9dd9af1747123a14e15ab9dc7deb24f6544fb" title="The float type. See mi::neuraylib::IType_float. ">mi::neuraylib::IType::TK_FLOAT</a>:</div>
<div class="line">                {</div>
<div class="line">                    <a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a> float_value = 0.0f;</div>
<div class="line">                    annotations.get_annotation_param_value&lt;<a class="code" href="group__mi__base__types.html#gac1b8c06a073706523d7a054c6e2a89c7" title="32-bit float. ">mi::Float32</a>&gt;( a, p, float_value);</div>
<div class="line">                    std::cout &lt;&lt; float_value &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                {</div>
<div class="line">                    <span class="comment">// type not handled in this example</span></div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;Address: &quot;</span> &lt;&lt; <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IValue&gt;</a>(</div>
<div class="line">                        annotations.get_annotation_param_value( a, p)).<span class="keyword">get</span>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// some other convenient helpers</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Index of \&quot;hard_range\&quot;: &quot;</span> &lt;&lt; annotations.get_annotation_index(</div>
<div class="line">        <span class="stringliteral">&quot;::anno::hard_range(float,float)&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Index of \&quot;foo\&quot;: &quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a><span class="keyword">&gt;</span>( annotations.get_annotation_index(</div>
<div class="line">        <span class="stringliteral">&quot;::anno::foo(int)&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot; (which is not present)\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* descValue = <span class="keyword">nullptr</span>;</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> res = annotations.get_annotation_param_value_by_name&lt;<span class="keyword">const</span> <span class="keywordtype">char</span>*&gt;(</div>
<div class="line">        <span class="stringliteral">&quot;::anno::description(string)&quot;</span>, 0, descValue);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Value of \&quot;description\&quot;: \&quot;&quot;</span> &lt;&lt; ( res == 0 ? descValue : <span class="stringliteral">&quot;nullptr&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> fooValue = 0;</div>
<div class="line">    res = annotations.get_annotation_param_value_by_name&lt;<a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a>&gt;(</div>
<div class="line">        <span class="stringliteral">&quot;::anno::foo(int)&quot;</span>, 0, fooValue);</div>
<div class="line">    <span class="keywordflow">if</span> ( res != 0)</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Value of \&quot;foo\&quot; not found (annotation is not present)\n&quot;</span>;</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Creates a variant of the example material with different defaults.</span></div>
<div class="line"><span class="keywordtype">void</span> create_variant( <a class="code" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a>* neuray, <a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html" title="A transaction provides a consistent view on the database. ">mi::neuraylib::ITransaction</a>* transaction)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IMdl_factory&gt;</a> mdl_factory(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>&gt;());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IType_factory&gt;</a> type_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#ae32b4ecd78cbbe5212f8daf1552180c3" title="Returns an MDL type factory for the given transaction. ">create_type_factory</a>( transaction));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IValue_factory&gt;</a> value_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a76919730caa41d98004f3edcff45d1df" title="Returns an MDL value factory for the given transaction. ">create_value_factory</a>( transaction));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IExpression_factory&gt;</a> expression_factory(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#aaa79f7a5d2d2973f7d34e007f22fc949" title="Returns an MDL expression factory for the given transaction. ">create_expression_factory</a>( transaction));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Prepare new defaults as clone of the current arguments of the material instance.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;( material_instance_name));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">        material_instance-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html#a979d0d5dd0a1d7cddc2346b68d8ac2e1" title="Returns all arguments. ">get_arguments</a>());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> defaults(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a050227a5e154a23fc3f09275f8bd7dde" title="Clones the given expression. ">clone</a>( arguments.get()));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create an ::anno::description annotation.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue&gt;</a> anno_arg_value(</div>
<div class="line">        value_factory-&gt;create_string(</div>
<div class="line">            <span class="stringliteral">&quot;a variant of ::nvidia::sdk_examples::tutorials::example_material&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot; with different defaults&quot;</span>));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> anno_arg_expression(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( anno_arg_value.get()));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> anno_args(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">    anno_args-&gt;add_expression( <span class="stringliteral">&quot;description&quot;</span>, anno_arg_expression.get());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IAnnotation&gt;</a> anno(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a49924ce37c5badb2ea81473bb92f2a96" title="Creates a new annotation. ">create_annotation</a>( <span class="stringliteral">&quot;::anno::description(string)&quot;</span>, anno_args.get()));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create an ::anno::hard_range annotation.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue&gt;</a> range_min_value( value_factory-&gt;create_float( 1.0));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue&gt;</a> range_max_value( value_factory-&gt;create_float( 1024.0));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> range_min_expression(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( range_min_value.get()));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> range_max_expression(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( range_max_value.get()));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> range_args(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">    range_args-&gt;add_expression( <span class="stringliteral">&quot;min&quot;</span>, range_min_expression.get());</div>
<div class="line">    range_args-&gt;add_expression( <span class="stringliteral">&quot;max&quot;</span>, range_max_expression.get());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IAnnotation&gt;</a> range_anno(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a49924ce37c5badb2ea81473bb92f2a96" title="Creates a new annotation. ">create_annotation</a>(</div>
<div class="line">            <span class="stringliteral">&quot;::anno::hard_range(float,float)&quot;</span>, range_args.get()));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add annotations to a annotation block.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IAnnotation_block&gt;</a> anno_block(</div>
<div class="line">        expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#ad6653541af9206fb3eecb789f251fe1a" title="Creates a new annotation block. ">create_annotation_block</a>());</div>
<div class="line">    anno_block-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IAnnotation__block.html#a1e133dfcbb4aff40939344a09f873002" title="Adds an annotation at the end of the annotation block. ">add_annotation</a>( anno.get());</div>
<div class="line">    anno_block-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IAnnotation__block.html#a1e133dfcbb4aff40939344a09f873002" title="Adds an annotation at the end of the annotation block. ">add_annotation</a>( range_anno.get());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Print the annotations just to illustrate the convince helper.</span></div>
<div class="line">    print_annotations( type_factory.get(), anno_block.get());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create the module bulder.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_execution_context&gt;</a> context(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#a78a9a6489592c90ea49e0fe0ac8be235" title="Creates an execution context. ">create_execution_context</a>());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_module_builder&gt;</a> module_builder(</div>
<div class="line">        mdl_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html#acfb3f3619135d5162196851186472dfb" title="Creates a module builder for a given module. ">create_module_builder</a>(</div>
<div class="line">            transaction,</div>
<div class="line">            <span class="stringliteral">&quot;mdl::variants&quot;</span>,</div>
<div class="line">            <a class="code" href="group__mi__neuray__mdl__types.html#gga2384b1621265603a8e992e92c7713050a141e8a79399c7a1007534d8a72aca3d8" title="MDL version 1.0. ">mi::neuraylib::MDL_VERSION_1_0</a>,</div>
<div class="line">            <a class="code" href="group__mi__neuray__mdl__types.html#gga2384b1621265603a8e992e92c7713050a7886f3144ca87e817fa21619f418ba40" title="Latest MDL version. ">mi::neuraylib::MDL_VERSION_LATEST</a>,</div>
<div class="line">            context.get()));</div>
<div class="line">    check_success( module_builder);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Create the variant.</span></div>
<div class="line">    check_success( module_builder-&gt;add_variant(</div>
<div class="line">        <span class="stringliteral">&quot;green_example_material&quot;</span>,</div>
<div class="line">        material_definition_name,</div>
<div class="line">        defaults.get(),</div>
<div class="line">        anno_block.get(),</div>
<div class="line">        <span class="comment">/*return_annotations*/</span> <span class="keyword">nullptr</span>,</div>
<div class="line">        <span class="comment">/*is_exported*/</span> <span class="keyword">true</span>,</div>
<div class="line">        context.get()) == 0);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Instantiate the material definition of the variant.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> material_definition(</div>
<div class="line">    transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#adafe2621ae719c43076b79a5677b4934" title="Retrieves an element from the database. ">access</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">        <span class="stringliteral">&quot;mdl::variants::green_example_material(color,float)&quot;</span>));</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result = 0;</div>
<div class="line">    material_instance = material_definition-&gt;create_function_call( 0, &amp;result);</div>
<div class="line">    check_success( result == 0);</div>
<div class="line"></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping material instance with defaults of material definition &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;\&quot;mdl::variants::green_example_material\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    dump_instance( expression_factory.get(), material_instance.get(), std::cout);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Export the variant.</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_impexp_api&gt;</a> mdl_impexp_api(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html" title="API component for MDL related import and export operations. ">mi::neuraylib::IMdl_impexp_api</a>&gt;());</div>
<div class="line">    check_success( mdl_impexp_api-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html#a1f38261cb179c96b0d74694e3ab28278" title="Exports an MDL module from the database to disk. ">export_module</a>( transaction, <span class="stringliteral">&quot;mdl::variants&quot;</span>, <span class="stringliteral">&quot;variants.mdl&quot;</span>) == 0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> MAIN_UTF8( <span class="keywordtype">int</span> <span class="comment">/*argc*/</span>, <span class="keywordtype">char</span>* <span class="comment">/*argv*/</span>[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Access the MDL SDK</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::INeuray&gt;</a> neuray(mi::examples::mdl::load_and_get_ineuray());</div>
<div class="line">    <span class="keywordflow">if</span> (!neuray.is_valid_interface())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to load the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Configure the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::configure(neuray.get()))</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start the MDL SDK</span></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> ret = neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#afdd076cf54b3e1eabbd841bd1f77847b" title="Starts the operation of the MDL SDK library. ">start</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK. Result code: %d&quot;</span>, ret);</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IDatabase&gt;</a> database(</div>
<div class="line">            neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IDatabase.html" title="This interface is used to interact with the distributed database. ">mi::neuraylib::IDatabase</a>&gt;());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IScope&gt;</a> scope( database-&gt;get_global_scope());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::ITransaction&gt;</a> transaction( scope-&gt;create_transaction());</div>
<div class="line"></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// Instantiate a material and function definition</span></div>
<div class="line">            instantiate_definitions( neuray.get(), transaction.get());</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Change the arguments of the instantiated definitions</span></div>
<div class="line">            change_arguments( neuray.get(), transaction.get());</div>
<div class="line"></div>
<div class="line">            <span class="comment">// Create a variant of the diffuse material with different defaults.</span></div>
<div class="line">            create_variant( neuray.get(), transaction.get());</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        transaction-&gt;<a class="code" href="classmi_1_1neuraylib_1_1ITransaction.html#aa4ff8152107db238986b364273bceb0c" title="Commits the transaction. ">commit</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Shut down the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a01d0574d048798c76f8e29f91a4f6fea" title="Shuts down the library. ">shutdown</a>() != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to shutdown the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Unload the MDL SDK</span></div>
<div class="line">    neuray = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::unload())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to unload the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    exit_success();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Convert command line arguments to UTF8 on Windows</span></div>
<div class="line">COMMANDLINE_TO_UTF8</div>
</div><!-- fragment --><div align="right"> [<a class="el" href="mi_neuray_example_modules.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_calls.html">Next</a>] </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path">
<span class="footeritem">5&#160;April&#160;2022,&#160;20:40, rev.358266</span>
<span class="footeritem"><a href="https://www.nvidia.com/en-us/about-nvidia/legal-info/" target="_blank" shape="rect">&copy; 2022 NVIDIA&nbsp;Corporation.</a> All rights reserved.</span>
</div>
</body>
</html>
