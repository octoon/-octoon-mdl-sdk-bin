<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Example for Function Calls</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="images/arcicon.ico" rel="shortcut icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_custom_stylesheet_1_8_4.css" rel="stylesheet" type="text/css"/>
<link rel='stylesheet' href='webfonts/librebaskerville/stylesheet.css' type='text/css'/>
<link rel='stylesheet' href='webfonts/sourcesanspro/stylesheet.css' type='text/css'/>
<!--ARC-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="blackheader">
<span id="blackheader_title">MDL SDK API</span>
<span>
<img src="images/nvidia_logo_transpbg.gif" alt="nvidia_logo_transpbg.gif" style=" height:1.25em; width:6.806em;"/></span>
<span id="blackheader_uplink">
<a href='../index.html' class='top_page_nav'>Up</a>
</span>
</div>
<!--
<div id="titlearea">
   <span id="projectname">
     <a id="titlelink" href="../../index.html">
       MDL SDK API
     </a>
   </span>
     <a id="projectlogo" href="http://www.nvidia-arc.com">
       <img alt="NVIDIA logo" src="images/nvidia_logo.png" style="height:2em;">
       </a>
     <a href='../index.html' class='top_page_nav'>Up</a>
</div>
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mi_neuray_example_calls.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Example for Function Calls </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="right"> [<a class="el" href="mi_neuray_example_instantiation.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_compilation.html">Next</a>] </div><p>This example uses function calls to create a textured material.</p>
<h1><a class="anchor" id="example_calls_new"></a>
New Topics</h1>
<ul>
<li>Rationale for expressions vs values</li>
<li>Creating a textured material</li>
</ul>
<h1><a class="anchor" id="example_calls_descr"></a>
Detailed Description</h1>
<dl>
<dt><b> Rationale for expressions vs values </b> </dt>
<dd><p class="startdd"><br/>
 Arguments of material instances and function calls are not values, but expressions. For example, the argument for the <code>"tint"</code> parameter in the <a class="el" href="mi_neuray_example_instantiation.html">previous example</a> is an instance of <a class="el" href="classmi_1_1neuraylib_1_1IExpression.html" title="The interface to MDL expressions. ">mi::neuraylib::IExpression</a>, and not of <a class="el" href="classmi_1_1neuraylib_1_1IValue__color.html" title="A value of type color. ">mi::neuraylib::IValue_color</a>. Why is this indirection needed?</p>
<p>If material instances and function calls are only used in isolation, simple values like <a class="el" href="classmi_1_1neuraylib_1_1IValue__color.html" title="A value of type color. ">mi::neuraylib::IValue_color</a> would be sufficient. However, much of the flexibility of MDL comes from the fact that one can create connections between material instances and function calls (provided the return type and the parameter type match). These connections are represented by call expressions while simple values are represented by constant expressions.</p>
<p class="enddd"></p>
</dd>
<dt><b> Creating a textured material </b> </dt>
<dd><p class="startdd"><br/>
 The method <code>create_textured_material()</code> shows all the steps needed to create a textured material in a bottom-up order. First we create a DB element of type <a class="el" href="classmi_1_1neuraylib_1_1IImage.html" title="This interface represents a pixel image file. ">mi::neuraylib::IImage</a> that represents the provided <code></code>.png file, and a DB element of type <a class="el" href="classmi_1_1neuraylib_1_1ITexture.html" title="Textures add image processing options to images. ">mi::neuraylib::ITexture</a> that references the image.</p>
<p>Next we load the MDL modules we want to use. The <code>example</code> module contains the material definition that we are going to use later. The <code>base</code> module contains a function definition that we are using in the next step to make use of the texture.</p>
<p>The function definition <code>base::file_texture()</code> is used to access the texture object in the DB. Apart from the texture name it provides several arguments to influence the texture lookup process. In this example we just set the texture name and leave the other arguments at their defaults. This step uses <a class="el" href="classmi_1_1neuraylib_1_1IModule.html#a534c99f1ef47b722fc621dfee8a643b0" title="Returns overloads of a function or material definition. ">mi::neuraylib::IModule::get_function_overloads()</a> to retrieve the exact name of a function definition (which includes the signature). Using this method frees one from hardcoding the signature if there is only one overload.</p>
<p>The return type of the function definition <code>base::file_texture()</code> is <code>base::texture_return</code>, a struct of two fields: <code>"tint"</code> of type <a class="el" href="classmi_1_1neuraylib_1_1IType__color.html" title="The type of kind color. ">mi::neuraylib::IType_color</a> and <code>"mono"</code> of type <a class="el" href="classmi_1_1neuraylib_1_1IType__float.html" title="The type of kind float. ">mi::neuraylib::IType_float</a>. Since the material definition we plan to use has a parameter of type <a class="el" href="classmi_1_1neuraylib_1_1IType__color.html" title="The type of kind color. ">mi::neuraylib::IType_color</a> we cannot directly attach the function call of <code>base::file_texture()</code>. Instead we have to isolate the <code>"tint"</code> field in the returned struct. This can be done by a so-called <em>member</em> <em>selection</em> <em>operator</em> (see <a class="el" href="group__mi__neuray__mdl__elements.html#mi_neuray_mdl_structs">Structs</a> for details). In this case, the name of the required struct getter is <code>base::texture_return.tint()</code>.</p>
<p>Finally, we connect the just created instance of the member selection operator to the <code>"tint"</code> argument of our diffuse material. The dump of the material instance and all function calls clearly shows the created call expressions.</p>
<p class="enddd"></p>
</dd>
</dl>
<h1><a class="anchor" id="example_calls"></a>
Example Source</h1>
<p><b>Source Code Location:</b> <code>examples/mdl_sdk/calls/example_calls.cpp</code></p>
<div class="fragment"><div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * Copyright 2022 NVIDIA Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// examples/mdl_sdk/calls/example_calls.cpp</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Uses function calls to create a textured material.</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;example_shared.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Utility function to dump the arguments of a material instance or function call.</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="keywordtype">void</span> dump_instance(</div>
<div class="line">    <a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html" title="The interface for creating expressions. ">mi::neuraylib::IExpression_factory</a>* expression_factory, <span class="keyword">const</span> T* material, std::ostream&amp; s)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> count = material-&gt;get_parameter_count();</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression_list&gt;</a> arguments( material-&gt;get_arguments());</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <a class="code" href="group__mi__base__types.html#gaa8e6476e3c0fc948ef75264572568791" title="Unsigned integral type that is large enough to hold the size of all types. ">mi::Size</a> index = 0; index &lt; count; index++) {</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IExpression&gt;</a> argument(</div>
<div class="line">            arguments-&gt;get_expression( index));</div>
<div class="line">        std::string name = material-&gt;get_parameter_name( index);</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IString&gt;</a> argument_text(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af61dee867b056fc0bdee1edc4707aa60" title="Returns a textual representation of an expression. ">dump</a>( argument.get(), name.c_str(), 1));</div>
<div class="line">        s &lt;&lt; <span class="stringliteral">&quot;    argument &quot;</span> &lt;&lt; argument_text-&gt;get_c_str() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">    s &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Creates a textured material.</span></div>
<div class="line"><span class="keywordtype">void</span> create_textured_material( <a class="code" href="classmi_1_1neuraylib_1_1INeuray.html" title="This is an object representing the MDL SDK library. ">mi::neuraylib::INeuray</a>* neuray)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IDatabase&gt;</a> database(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IDatabase.html" title="This interface is used to interact with the distributed database. ">mi::neuraylib::IDatabase</a>&gt;());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IScope&gt;</a> scope( database-&gt;get_global_scope());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::ITransaction&gt;</a> transaction( scope-&gt;create_transaction());</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_impexp_api&gt;</a> mdl_impexp_api(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__impexp__api.html" title="API component for MDL related import and export operations. ">mi::neuraylib::IMdl_impexp_api</a>&gt;());</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IMdl_factory&gt;</a> mdl_factory(</div>
<div class="line">        neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a4e107568bbb0e64f61fb4b59b93607fa" title="Returns an API component from the MDL SDK API. ">get_api_component</a>&lt;<a class="code" href="classmi_1_1neuraylib_1_1IMdl__factory.html" title="Factory for various MDL interfaces and functions. ">mi::neuraylib::IMdl_factory</a>&gt;());</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IValue_factory&gt;</a> value_factory(</div>
<div class="line">        mdl_factory-&gt;create_value_factory( transaction.get()));</div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html">mi::base::Handle&lt;mi::neuraylib::IExpression_factory&gt;</a> expression_factory(</div>
<div class="line">        mdl_factory-&gt;create_expression_factory( transaction.get()));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IMdl_execution_context&gt;</a> context(</div>
<div class="line">        mdl_factory-&gt;create_execution_context());</div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Create a DB element for the image and the texture referencing it.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IImage&gt;</a> image(</div>
<div class="line">            transaction-&gt;create&lt;<a class="code" href="classmi_1_1neuraylib_1_1IImage.html" title="This interface represents a pixel image file. ">mi::neuraylib::IImage</a>&gt;( <span class="stringliteral">&quot;Image&quot;</span>));</div>
<div class="line">        check_success( image-&gt;reset_file( <span class="stringliteral">&quot;nvidia/sdk_examples/resources/example.png&quot;</span>) == 0);</div>
<div class="line">        transaction-&gt;store( image.get(), <span class="stringliteral">&quot;nvidia_image&quot;</span>);</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::ITexture&gt;</a> texture(</div>
<div class="line">            transaction-&gt;create&lt;<a class="code" href="classmi_1_1neuraylib_1_1ITexture.html" title="Textures add image processing options to images. ">mi::neuraylib::ITexture</a>&gt;( <span class="stringliteral">&quot;Texture&quot;</span>));</div>
<div class="line">        texture-&gt;set_image( <span class="stringliteral">&quot;nvidia_image&quot;</span>);</div>
<div class="line">        <span class="comment">// Setting the gamma override value here is not strictly necessary, since the canvas of</span></div>
<div class="line">        <span class="comment">// the image has already a gamma value of 2.2. However, if new MDL source code is</span></div>
<div class="line">        <span class="comment">// generated based on this texture, the explicit setting here causes &quot;::tex::gamma_srgb&quot; to</span></div>
<div class="line">        <span class="comment">// be used instead of &quot;::tex::gamma_default&quot;, which might be desired.</span></div>
<div class="line">        texture-&gt;set_gamma( 2.2f);</div>
<div class="line">        transaction-&gt;store( texture.get(), <span class="stringliteral">&quot;nvidia_texture&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Import the &quot;::nvidia::sdk_examples::tutorials&quot; and &quot;base&quot; module. The</span></div>
<div class="line">        <span class="comment">// &quot;::nvidia::sdk_examples::tutorials&quot; module is found via the configured module search</span></div>
<div class="line">        <span class="comment">// path.</span></div>
<div class="line">        check_success( mdl_impexp_api-&gt;load_module(</div>
<div class="line">            transaction.get(), <span class="stringliteral">&quot;::nvidia::sdk_examples::tutorials&quot;</span>, context.get()) &gt;= 0);</div>
<div class="line">        check_success( print_messages( context.get()));</div>
<div class="line">        check_success( mdl_impexp_api-&gt;load_module(</div>
<div class="line">            transaction.get(), <span class="stringliteral">&quot;::base&quot;</span>, context.get()) &gt;= 0);</div>
<div class="line">        check_success( print_messages( context.get()));</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Lookup the exact name of the DB element for the MDL function &quot;base::file_texture&quot;.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IModule&gt;</a> module(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IModule.html" title="This interface represents an MDL module. ">mi::neuraylib::IModule</a>&gt;( <span class="stringliteral">&quot;mdl::base&quot;</span>));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IArray&gt;</a> overloads(</div>
<div class="line">            module-&gt;get_function_overloads( <span class="stringliteral">&quot;mdl::base::file_texture&quot;</span>));</div>
<div class="line">        check_success( overloads-&gt;get_length() == 1);</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::IString&gt;</a> file_texture_name(</div>
<div class="line">            overloads-&gt;get_element&lt;<a class="code" href="classmi_1_1IString.html" title="A simple string class. ">mi::IString</a>&gt;( static_cast&lt;mi::Uint32&gt;( 0)));</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Prepare the arguments of the function call for &quot;mdl::base::file_texture&quot;: set the</span></div>
<div class="line">        <span class="comment">// &quot;texture&quot; argument to the &quot;nvidia_texture&quot; texture.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> function_definition(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">                file_texture_name-&gt;get_c_str()));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IType_list&gt;</a> types(</div>
<div class="line">            function_definition-&gt;get_parameter_types());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IType&gt;</a> arg_type( types-&gt;get_type( <span class="stringliteral">&quot;texture&quot;</span>));</div>
<div class="line">        check_success( arg_type.is_valid_interface());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IValue_texture&gt;</a> arg_value(</div>
<div class="line">            value_factory-&gt;create&lt;<a class="code" href="classmi_1_1neuraylib_1_1IValue__texture.html" title="A texture value. ">mi::neuraylib::IValue_texture</a>&gt;( arg_type.get()));</div>
<div class="line">        check_success( arg_value.is_valid_interface());</div>
<div class="line">        check_success( arg_value-&gt;set_value( <span class="stringliteral">&quot;nvidia_texture&quot;</span>) == 0);</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> arg_expr(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a774749a982e8b8e8910e01e11ec39d59" title="Creates a constant (mutable). ">create_constant</a>( arg_value.get()));</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">        arguments-&gt;add_expression( <span class="stringliteral">&quot;texture&quot;</span>, arg_expr.get());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Create a function call from the function definition &quot;mdl::base::file_texture&quot; with the</span></div>
<div class="line">        <span class="comment">// just prepared arguments.</span></div>
<div class="line">        <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result;</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> function_call(</div>
<div class="line">            function_definition-&gt;create_function_call( arguments.get(), &amp;result));</div>
<div class="line">        check_success( result == 0);</div>
<div class="line">        transaction-&gt;store( function_call.get(), <span class="stringliteral">&quot;call of file_texture&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Prepare the arguments of the function call for &quot;mdl::base::texture_return.tint&quot;: set the</span></div>
<div class="line">        <span class="comment">// &quot;s&quot; argument to the &quot;call of file_texture&quot; function call.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> arg_expr(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a14f1dcbdac8009ed0ba686357ffac72f" title="Creates a call. ">create_call</a>( <span class="stringliteral">&quot;call of file_texture&quot;</span>));</div>
<div class="line">        check_success( arg_expr.is_valid_interface());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">        arguments-&gt;add_expression( <span class="stringliteral">&quot;s&quot;</span>, arg_expr.get());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Create a function call from the function definition &quot;mdl::base::file_texture&quot; with the</span></div>
<div class="line">        <span class="comment">// just prepared arguments.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> function_definition(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">                <span class="stringliteral">&quot;mdl::base::texture_return.tint(::base::texture_return)&quot;</span>));</div>
<div class="line">        <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result;</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> function_call(</div>
<div class="line">            function_definition-&gt;create_function_call( arguments.get(), &amp;result));</div>
<div class="line">        check_success( result == 0);</div>
<div class="line">        transaction-&gt;store( function_call.get(), <span class="stringliteral">&quot;call of texture_return.tint&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Prepare the arguments of the material instance for</span></div>
<div class="line">        <span class="comment">// &quot;mdl::nvidia::sdk_examples::tutorials::example_material&quot;:</span></div>
<div class="line">        <span class="comment">// set the &quot;tint&quot; argument to the &quot;call of texture_return.tint&quot; function call.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression&gt;</a> arg_expr(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#a14f1dcbdac8009ed0ba686357ffac72f" title="Creates a call. ">create_call</a>( <span class="stringliteral">&quot;call of texture_return.tint&quot;</span>));</div>
<div class="line">        check_success( arg_expr.is_valid_interface());</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IExpression_list&gt;</a> arguments(</div>
<div class="line">            expression_factory-&gt;<a class="code" href="classmi_1_1neuraylib_1_1IExpression__factory.html#af0b7dbd66ce98752e05c51e350678a78" title="Creates a new expression list. ">create_expression_list</a>());</div>
<div class="line">        arguments-&gt;add_expression( <span class="stringliteral">&quot;tint&quot;</span>, arg_expr.get());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Create a material instance from the material definition</span></div>
<div class="line">        <span class="comment">// &quot;mdl::nvidia::sdk_examples::tutorials::example_material&quot;</span></div>
<div class="line">        <span class="comment">// with the just prepared arguments.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_definition&gt;</a> material_definition(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__definition.html" title="This interface represents a function definition. ">mi::neuraylib::IFunction_definition</a>&gt;(</div>
<div class="line">                <span class="stringliteral">&quot;mdl::nvidia::sdk_examples::tutorials::example_material(color,float)&quot;</span>));</div>
<div class="line">        <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> result;</div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">            material_definition-&gt;create_function_call( arguments.get(), &amp;result));</div>
<div class="line">        check_success( result == 0);</div>
<div class="line">        transaction-&gt;store( material_instance.get(), <span class="stringliteral">&quot;instance of example_material&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Dump the created material instance and function calls.</span></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_call&gt;</a> material_instance(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;(</div>
<div class="line">                <span class="stringliteral">&quot;instance of example_material&quot;</span>));</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping material instance \&quot;instance of example_material\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), material_instance.get(), std::cout);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;const mi::neuraylib::IFunction_call&gt;</a> function_call(</div>
<div class="line">            transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;(</div>
<div class="line">                <span class="stringliteral">&quot;call of texture_return.tint&quot;</span>));</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping function call \&quot;call of texture_return.tint\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), function_call.get(), std::cout);</div>
<div class="line"></div>
<div class="line">        function_call = transaction-&gt;access&lt;<a class="code" href="classmi_1_1neuraylib_1_1IFunction__call.html" title="This interface represents a function call. ">mi::neuraylib::IFunction_call</a>&gt;(</div>
<div class="line">            <span class="stringliteral">&quot;call of file_texture&quot;</span>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Dumping function call \&quot;call of file_texture\&quot;:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        dump_instance( expression_factory.get(), function_call.get(), std::cout);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    transaction-&gt;commit();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> MAIN_UTF8( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Access the MDL SDK</span></div>
<div class="line">    <a class="code" href="classmi_1_1base_1_1Handle.html" title="Handle class template for interfaces, automatizing the lifetime control via reference counting...">mi::base::Handle&lt;mi::neuraylib::INeuray&gt;</a> neuray(mi::examples::mdl::load_and_get_ineuray());</div>
<div class="line">    <span class="keywordflow">if</span> (!neuray.is_valid_interface())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to load the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Configure the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::configure(neuray.get()))</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start the MDL SDK</span></div>
<div class="line">    <a class="code" href="group__mi__base__types.html#gafcdcb44319b0596ee8a9a44fddaec8c6" title="32-bit signed integer. ">mi::Sint32</a> ret = neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#afdd076cf54b3e1eabbd841bd1f77847b" title="Starts the operation of the MDL SDK library. ">start</a>();</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to initialize the SDK. Result code: %d&quot;</span>, ret);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Create a textured material</span></div>
<div class="line">    create_textured_material( neuray.get());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Shut down the MDL SDK</span></div>
<div class="line">    <span class="keywordflow">if</span> (neuray-&gt;<a class="code" href="classmi_1_1neuraylib_1_1INeuray.html#a01d0574d048798c76f8e29f91a4f6fea" title="Shuts down the library. ">shutdown</a>() != 0)</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to shutdown the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Unload the MDL SDK</span></div>
<div class="line">    neuray = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (!mi::examples::mdl::unload())</div>
<div class="line">        exit_failure(<span class="stringliteral">&quot;Failed to unload the SDK.&quot;</span>);</div>
<div class="line"></div>
<div class="line">    exit_success();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Convert command line arguments to UTF8 on Windows</span></div>
<div class="line">COMMANDLINE_TO_UTF8</div>
</div><!-- fragment --><div align="right"> [<a class="el" href="mi_neuray_example_instantiation.html">Previous</a>] [<a class="el" href="mi_neuray_examples.html">Up</a>] [<a class="el" href="mi_neuray_example_compilation.html">Next</a>] </div> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path">
<span class="footeritem">5&#160;April&#160;2022,&#160;20:40, rev.358266</span>
<span class="footeritem"><a href="https://www.nvidia.com/en-us/about-nvidia/legal-info/" target="_blank" shape="rect">&copy; 2022 NVIDIA&nbsp;Corporation.</a> All rights reserved.</span>
</div>
</body>
</html>
